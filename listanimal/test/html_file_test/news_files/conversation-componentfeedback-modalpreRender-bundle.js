(window.webpackJsonp_spotim_4006192861=window.webpackJsonp_spotim_4006192861||[]).push([[14],{111:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(29),a=n.n(r),o=n(9),s=n.n(o),i=n(10),c=n.n(i),u=n(677),l=n.n(u),d=n(90),p=n(0),f=n.n(p),m=n(11),v=n(67),g=n(32);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h,O=function(){},I=f.a.get("init_data.config.avatars.scheme"),E=f.a.get("tenant_config.shared.disable_user_image_upload",!1);!function(e){e[e.XXX_LARGE=114]="XXX_LARGE",e[e.XX_LARGE=74]="XX_LARGE",e[e.X_LARGE=64]="X_LARGE",e[e.LARGE=54]="LARGE",e[e.MEDIUM=42]="MEDIUM",e[e.NORMAL=30]="NORMAL",e[e.SMALL=25]="SMALL"}(h||(h={}));t.b=Object(m.connect)((function(e){var t=e.moduleOptions;return{enableSSO:t.enableSSO,editableSSO:t.editableSSO,currentUser:e.currentUser}}))((function(e){var t,n=e.isOnline,r=e.size,a=e.disableUserImageUpload,o=e.disableTooltip,i=e.onImageUpload,u=e.className,p=e.overrideImageId,f=e.onClick,m=void 0===f?O:f,y=e.disableOnlineIndicator,h=e.isBranding,k=void 0!==h&&h,w=e.enableSSO,C=e.editableSSO,_=e.currentUser,T=e.user,j=e.isDisabled,S=a||!Object(v.d)(_)&&E||!!w&&!C,x=void 0;return p?x=p:(null==T?void 0:T.imageId)||(x="#Grey-Default"),g.n?null:T?s.a.createElement(d.UserImage,{size:r,isOnline:n,className:c()(l.a.userImageAvatar,{[l.a.disabled]:j},u),avatarsScheme:I,disableUserImageUpload:S,user:b(b({},T),{},{imageId:null!==(t=x)&&void 0!==t?t:T.imageId}),onClick:k?O:m,onImageUpload:i,disableOnlineIndicator:y,disableTooltip:o}):null}))},170:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m}));var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(69);function c(e,t){var n={spot_id:e,conversation_id:t};return Object(i.a)("moderation/toggle-hide/spot/".concat(e,"/conversation/").concat(t),{data:n,method:"POST"})}function u(e){return l.apply(this,arguments)}function l(){return(l=s()(a.a.mark((function e(t){var n,r,o,s,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,o=t.communityQuestion,e.next=3,Object(i.a)("moderation/community-question/spot/".concat(n,"/conversation/").concat(r),{data:{community_question:o},method:"POST"});case 3:return s=e.sent,c=s.body,u=c.success,e.abrupt("return",{isSuccess:!1!==u});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){var t=e.messageId;return Object(i.a)("moderation/internal/mark-as-global-spam/".concat(t),{method:"POST"})}function p(e){return f.apply(this,arguments)}function f(){return(f=s()(a.a.mark((function e(t){var n,r,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,e.next=3,Object(i.a)("moderation/conversation-default-policy/spot/".concat(n,"/conversation/").concat(r),{});case 3:return o=e.sent,s=o.body,c=s.default_policy,e.abrupt("return",{defaultPolicy:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=s()(a.a.mark((function e(t){var n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,o=t.newPolicy,e.next=3,Object(i.a)("moderation/conversation-default-policy/spot/".concat(n,"/conversation/").concat(r,"/").concat(o),{method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},174:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(37),c=n(23),u=n(49),l=n(440),d=n(2),p=n(441),f=n(76),m=n(409);var v=n(117),g=n(44);function y(e,t){return b.apply(this,arguments)}function b(){return(b=s()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={stars:t},e.next=3,Object(g.a)("v1.0.0/conversation/rate",{postId:n,method:"POST",data:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=n(67);function O(e){var t=e.rootMessageId,n=void 0===t?null:t,r=e.replyId,o=void 0===r?null:r,g=e.depth,y=void 0===g?0:g,b=e.entities,O=e.replyToStackId,E=void 0===O?null:O,k=e.parentMessageId,w=void 0===k?null:k,C=e.replyToUserId,_=void 0===C?null:C,T=e.replyToUsername,j=void 0===T?null:T,S=e.replyToDisplayName,x=void 0===S?null:S,M=e.displayName,P=void 0===M?null:M,R=e.starsRating,D=void 0===R?0:R,N=e.isRetry,L=void 0!==N&&N,U=e.id,B=void 0===U?void 0:U,A=e.dontModerate,V=void 0!==A&&A;return function(){var e=s()(a.a.mark((function e(t,r){var s,g,O,k,C,T,S,M,R,N,U,A;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r(),g=s.comments,O=s.currentUser,k=s.moduleOptions.forceRegister,C=D>0,T=!V&&!L&&Object(f.h)(s,w),S=g.failedMessageTemp,!L&&S&&t((q={message:null==S?void 0:S.message},{type:c.l,payload:q})),b&&0!==b.length||C){e.next=8;break}return e.abrupt("return",t({type:c.r,payload:{error:"Create message: no entities"},error:!0}));case 8:if((M=!!b.find((function(e){return e.type===m.a.TEXT&&e.text.length>0||e.type!==m.a.TEXT})))||C){e.next=11;break}return e.abrupt("return",t({type:c.r,payload:{error:"Create message: no content"},error:!0}));case 11:if(!k||O.isRegistered){e.next=13;break}return e.abrupt("return",t({type:c.r,payload:{error:"Force register to comment"},error:!0}));case 13:if(R=B||Object(v.a)(),N=b.map((function(e){switch(e.type){case m.a.TEXT:return Object(i.textToBackendJson)(e);case m.a.MENTION:return Object(i.mentionToBackendJson)(e);case m.a.IMAGE:return Object(i.imageToBackendJson)(e);case m.a.LINK:return Object(i.linkToBackendJson)(e);case m.a.VIDEO:return Object(i.videoToBackendJson)(e);case m.a.FRAME:return Object(i.frameToBackendJson)(e);case m.a.ANIMATION:return Object(i.animationToBackendJson)(e);default:return null}})),U={id:R,isTempId:!0,rootMessageId:n,postedAt:(a=new Date,a.getTime()/1e3),replyId:o,entities:b,userDisplayName:P,user:O,parentMessageId:w,replyToUserId:_,replyToUsername:j,replyToDisplayName:x,starsRating:D,depth:y},A="create_".concat(0===y?"comment":"reply"),d.a.apm.start(A),t({type:c.r,payload:{currentUser:O,isLoggedIn:Object(u.d)(O),message:U,replyToStackId:E,isRetry:L}}),Object(h.f)(O.id),M||!C){e.next=24;break}return e.abrupt("return",t(I({tempMessageId:R,message:U})));case 24:if(!T){e.next=26;break}return e.abrupt("return",t(Object(p.b)({entities:N,message:U,tempId:R,isRetry:L})));case 26:return e.abrupt("return",t(Object(l.a)({tempMessageId:R,message:U,isRetry:L})));case 27:case"end":return e.stop()}var a,q}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function I(e){e.tempMessageId;var t=e.message;return function(){var e=s()(a.a.mark((function e(n,r){var o,s,i,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.starsRating,s=r(),i=s.currentUser,l=s.moduleOptions.postId,e.prev=2,d.a.apm.start("create_stars_rating"),e.next=6,y(o,l);case 6:if(p=e.sent,d.a.apm.end("create_stars_rating"),"ok"!==(null==p?void 0:p.status)){e.next=12;break}return e.abrupt("return",n({type:c.q,payload:{message:t,isLoggedIn:Object(u.d)(i)}}));case 12:return d.a.error("create_stars_rating","Create stars rating failed"),n({type:c.M,payload:{message:t}}),e.abrupt("return",n({type:c.q,payload:{error:"Create stars rating failed"},error:!0}));case 15:e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(2),d.a.error("create_stars_rating",e.t0),n({type:c.M,payload:{message:t}}),e.abrupt("return",n({type:c.q,payload:{error:"Create stars rating failed",message:t},error:!0}));case 22:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,n){return e.apply(this,arguments)}}()}n.d(t,"a",(function(){return O}))},176:function(e,t,n){"use strict";var r=n(44),a=function(e,t){return Object(r.a)("v1.0.0/moderation/verdict/afterclick",{method:"POST",postId:e,data:t})},o=function(e,t){return Object(r.a)("v1.0.0/moderation/verdict/realtime",{method:"POST",postId:e,data:t})},s=function(e){return Object(r.a)("v1.0.0/moderation/verdict/user-suspended",{method:"GET",postId:e,data:{}})};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}))},258:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),a=n.n(r).a.get("tenant_config.conversation.enable_community_view",!1)},259:function(e,t,n){"use strict";function r(e){return document.querySelector('[data-module-element-id="'.concat(e,'"] [data-spot-im-shadow-host]'))}function a(e){var t,n;return null!==(t=null===(n=r(e))||void 0===n?void 0:n.shadowRoot)&&void 0!==t?t:document}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},396:function(e,t,n){"use strict";var r=n(24),a=n.n(r),o=n(25),s=n.n(o),i=n(26),c=n.n(i),u=n(27),l=n.n(u),d=n(28),p=n.n(d),f=n(41),m=n.n(f),v=n(9),g=n.n(v),y=n(37),b=n(672),h=n.n(b),O=n(397),I=n(10),E=n.n(I),k=n(45),w=n(40),C=n(33),_=n(34),T=n.n(_),j=n(78);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l()(this,n)}}var x=function(e){c()(n,e);var t=S(n);function n(){var e;a()(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).handleClick=function(t){var n=e.props,r=n.tracking,a=n.onClick,o=n.postId;a({connectType:y.connectTypes.DISQUS,event:t});var s={type:"disqus-login-clicked",post_id:o};r.trackEvent(s)},e.handleDisqusLogin=function(t){13===t.keyCode&&e.handleClick(t)},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.t;return t=E()(t,h.a.disqusTitle),g.a.createElement("span",{className:t,onKeyUp:this.handleDisqusLogin,onClick:this.handleClick,"data-title":n("connectWithDisqus","Connect With Disqus"),"aria-label":n("connectWithDisqus","Connect With Disqus"),"data-balloon-pos":"up"},Object(w.b)()?g.a.createElement(k.a,{className:h.a.DisqusIcon,selector:"disqusIcon"}):g.a.createElement(j.a,{disableHover:!0,className:h.a.disqusText},g.a.createElement(C.a,{i18nKey:"connectWithDisqus"},"Connect With Disqus")),g.a.createElement("div",{className:h.a.disqusSpacer}))}}]),n}(v.Component);t.a=m()(T()({}),Object(O.a)())(x)},403:function(e,t,n){"use strict";t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.content,a=n.attributes;return new Promise((function(n,o){var s=document.createElement("script");if(s.type="text/javascript",t&&(s.addEventListener("load",n,!1),s.addEventListener("error",o,!1),s.src=t),r&&(s.text=r),a&&Object.keys(a).forEach((function(e){s.setAttribute(e,a[e])})),e.appendChild(s),!t)return n()}))}},405:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(23),c=n(2),u=n(170);function l(){return function(){var e=s()(a.a.mark((function e(t,n){var r,o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n(),o=r.conversation.id,s=r.moduleOptions.spotId,t({type:i.eb}),e.next=5,Object(u.d)(s,o);case 5:t({type:i.hb}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t({type:i.hb,payload:{error:e.t0,spotId:spotId,conversationId:conversationId},error:!0}),c.a.error("toggleHideConversation",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()}},407:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(23),a=n(36),o=n(81),s=n(74),i=n(354),c=n(1),u=n(42);function l(e){return function(t,n){var l=n(),d=l.conversation,p=l.comments.list,f=l.moduleOptions.isConversationLiveBlog,m=l.liveBlogConfig,v=Object(i.a)(e),g=v.user,y=v.message;if(!o.c(p,y.id)){y.isNew=!0;var b=s.b({message:y,id:y.id});t({type:r.W,payload:{user:g,message:y,shouldAggregate:Object(a.n)(l),messageStack:b}})}var h={source:f?"live-blog":"conversation",[f?"eventCode":"postId"]:d.postId,fromUser:{id:g.id,username:g.username,displayName:g.displayName},message:{type:0===y.depth?"comment":"reply",time:new Date(1e3*y.postedAt).getTime()}};if(f){var O=m.reporters.includes(g.id);h.fromUser.isReporter=O}Object(c.dispatchSpotimEvent)(u.q,h)}}},409:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.TEXT="text",e.IMAGE="image",e.LINK="link",e.VIDEO="video",e.MENTION="user-mention",e.FRAME="frame",e.ANIMATION="animation"}(r||(r={}))},410:function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(){return"dark"===a.a.get("init_data.config.inpage_skin")}},440:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(29),s=n.n(o),i=n(22),c=n.n(i),u=n(23),l=n(49),d=n(2),p=n(0),f=n.n(p),m=n(120),v=n(176),g=n(91),y=n(65),b=n(37),h=function(e,t){return Object(y.h)("message/".concat(t,"/status"),{method:"GET",postId:e,data:{}})},O=f.a.get("tenant_config.conversation.status_fetch_interval_in_ms",300),I=f.a.get("tenant_config.conversation.status_fetch_timeout_in_ms",3e3),E=f.a.get("tenant_config.conversation.status_fetch_retry_count",12),k=f.a.get("tenant_config.conversation.status_fetch_default_fallback_status",b.statuses.APPROVED);function w(e,t){return C.apply(this,arguments)}function C(){return(C=c()(a.a.mark((function e(t,n){var r,o,s,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:0,e.prev=1,!(++r<=E)){e.next=15;break}return e.next=6,h(n,t);case 6:if(o=e.sent,"processing"!==(s=o.status)){e.next=12;break}return e.next=11,_(O);case 11:return e.abrupt("return",w(t,n,r));case 12:return e.abrupt("return",s);case 15:if(status){e.next=19;break}return e.abrupt("return",k);case 19:return e.abrupt("return",status);case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(1),d.a.error("runFetchMessageStatus",e.t0),e.abrupt("return",w(t,n,r));case 26:case"end":return e.stop()}}),e,null,[[1,22]])})))).apply(this,arguments)}function _(e){return T.apply(this,arguments)}function T(){return(T=c()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return new Promise(function(){var n=c()(a.a.mark((function n(r){var o,s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=setTimeout((function(){r(k)}),I),n.next=3,w(e,t);case 3:s=n.sent,r(s),clearTimeout(o);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}var S=function(e,t){return Object(y.h)("retry-status/".concat(e),{method:"GET",postId:t,data:{}})};function x(e,t,n,r){return Object.assign(e,{entities:e.entities?e.entities:e.content,type:t,commenter_id:r,metadata:{scope:n},stars:e.stars,users:[],starsRating:e.stars}),delete e.content,e}function M(e){return e&&"processing"!==e?e:""}var P=n(1),R=n(42);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"a",(function(){return U}));var L=f.a.get("tenant_config.moderation.retry_debug_enabled",!1);function U(e){var t=e.tempMessageId,n=e.message,r=e.isRetry,o=void 0!==r&&r;return function(){var e=c()(a.a.mark((function e(r,s){var i,c,p,g,b,h,O,I,E,k,w,C,_,T,D,U,V,q,H,W,G,F,X,K,Q,J;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(i=n).rootMessageId,p=i.replyId,g=i.depth,b=i.entities,h=i.replyToStackId,O=i.parentMessageId,I=i.replyToUserId,E=i.replyToUsername,k=i.replyToDisplayName,w=i.userDisplayName,C=i.starsRating,_=s(),T=_.currentUser,D=_.conversation,U=_.moduleOptions.postId,V=f.a.get("tenant_config.moderation.content_aware_events",!1),q=A(s,n),H=b.filter((function(e){return"text"!==e.type||"text"===e.type&&""!==e.text})),W=g>0?"reply":"comment",Object(P.dispatchSpotimEvent)(R.k,{postId:U}),F=!0,!o){e.next=21;break}return e.prev=9,e.next=12,S(t,U);case 12:X=e.sent,K=X.message_id,Q=X.status,K&&(F=!1,r((Z={tempMessageId:t,messageId:K},{type:u.j,payload:Z})),n.id=K,n.status=M(Q),G=N(N({},G),{},{body:n})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(9),d.a.error("publishMessage",e.t0);case 21:if(e.prev=21,!F){e.next=35;break}if(!(g>0)){e.next=30;break}return J=g>1?O:null,e.next=27,y.e({conversationId:D.id,rootMessageId:c,replyToMessageId:J,entities:H,postId:U,displayName:w,contentType:D.contentType,tempMessageId:t,starsRating:C});case 27:G=e.sent,e.next=33;break;case 30:return e.next=32,y.d({conversationId:D.id,postId:U,entities:H,displayName:w,tempMessageId:t,contentType:D.contentType,starsRating:C});case 32:G=e.sent;case 33:if(!L){e.next=35;break}throw new Error("Retry Debug Error");case 35:e.next=41;break;case 37:return e.prev=37,e.t1=e.catch(21),d.a.error("publishMessage",e.t1),e.abrupt("return",r({type:u.q,payload:{error:e.t1,message:{id:t,rootMessageId:c,parentMessageId:O,replyId:p,depth:g,entities:H,replyToStackId:h,replyToUserId:I,replyToUsername:E,replyToDisplayName:k,displayName:w,starsRating:C,user:T},isRetry:o},error:!0}));case 41:if(e.prev=41,!G){e.next=53;break}if(""!==(n=x(G.body,W,D.contentType,T.id)).status){e.next=48;break}return e.next=47,j(n.id,U);case 47:n.status=e.sent;case 48:return Object.assign(n,{depth:g,tempMessageId:t,isTempId:!1,isNew:!0,parentMessageId:O,replyToUserId:I,replyToUsername:E,replyToDisplayName:k,rootMessageId:c,user:T}),V&&Object(v.a)(U,{content:H,stars:C,metadata:{},unique_content_id:q.tempMessageId||t,actual_message_id:n.id}),B(s,{message:n,currentUser:T,tempMessageId:t}),n.status=(a=n.status,z=void 0,Y=void 0,z=a,Y=f.a.get("init_data.config.policy.roger_mode",!1),"require_approval"===a&&(z=m.d),"block_all"===a&&(z=m.b),z!==m.a&&Y&&(z=m.a),z),e.abrupt("return",r({type:u.q,payload:{message:n,isLoggedIn:Object(l.d)(T),isRetry:o}}));case 53:e.next=58;break;case 55:e.prev=55,e.t2=e.catch(41),d.a.error("publishMessage",e.t2);case 58:case"end":return e.stop()}var a,z,Y,Z}),e,null,[[9,18],[21,37],[41,55]])})));return function(t,n){return e.apply(this,arguments)}}()}function B(e,t){var n=t.message,r=t.currentUser,a=t.tempMessageId,o=A(e,n),s=e(),i=s.moduleOptions.postId,c=s.conversation,u=N({message_id:n.id,user_id:r.id,is_registered:r.isRegistered,conversation_id:c.id,post_id:i,native:o.tempMessageId||a},function(e,t){return{item_id:(n=t,r=n.isMessageBlocked,a=n.isModerationAlertVisible,r?a?"post-anyway":"after-edit":"first-try"),segment:e.status};var n,r,a}(n,o));0===n.depth?Object.assign(u,{type:"commented"}):n.depth>0&&Object.assign(u,{type:"replied",relatedMessageId:n.parentMessageId}),Object(g.analyticsTrack)(u)}function A(e,t){var n=e(),r=n.mainSayControl,a=n.messageSayControls;return t.depth>0&&t.parentMessageId?a[t.parentMessageId]:r}},441:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(440),c=n(23),u=n(29),l=n.n(u),d=n(52),p=n.n(d),f=n(91);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var v=function(e){return function(t,n){var r,a=null===(r=n())||void 0===r?void 0:r.moduleOptions,o=a.spotId,s=a.postId;Object(f.analyticsTrack)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({spot_id:o,post_id:s},e))}};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var y=function(e){return function(t,n){var r=n().currentUser,a=r.isRegistered,o=r.id;t(v(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({item_type:"realtime-moderation",user_id:o,is_registered:a},e)))}};function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=e.isUserSuspended,n=e.verdict,r=e.taggers,a=e.isMessageBlockedVerdict,o=p()(e,["isUserSuspended","verdict","taggers","isMessageBlockedVerdict"]);return function(e,s){return t&&e(y({type:"suspension-triggered"})),e({type:c.Eb,payload:h({isUserSuspended:t,verdict:n,taggers:r,isMessageBlockedVerdict:a},o)})}}var I=n(76),E=n(176),k=n(409),w=n(121),C=n(2),_=n(49);function T(e){var t=e.entities,n=void 0===t?[]:t,r=e.message,o=e.tempId,u=e.isRetry;return function(){var e=s()(a.a.mark((function e(t,s){var l,d,p,f,m,v,g,y,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=r.starsRating,d=r.user,p=j(n),f=s(),m=f.moduleOptions.postId,e.next=6,Object(E.a)(m,{content:p,stars:l,metadata:{},unique_content_id:o});case 6:if(v=e.sent,g=v.verdict,y=v.tags,b=I.c(g,y),!(I.f()&&y.includes(w.a.SUSPENDED))){e.next=13;break}return e.abrupt("return",t(O({currentUser:d,isUserSuspended:!0,isLoggedIn:Object(_.d)(d),message:r,verdict:g,taggers:y,isMessageBlockedVerdict:b})));case 13:if(!b){e.next=15;break}return e.abrupt("return",t({type:c.I,payload:{currentUser:d,isLoggedIn:Object(_.d)(d),message:r,verdict:g,taggers:y,isMessageBlockedVerdict:b,tempId:o}}));case 15:return e.abrupt("return",t(Object(i.a)({tempMessageId:o,message:r,isRetry:u,isMessageBlockedVerdict:b,taggers:y,verdict:g})));case 18:return e.prev=18,e.t0=e.catch(0),C.a.error("moderateAndPublishMessage",e.t0),e.abrupt("return",t(Object(i.a)({tempMessageId:o,message:r,isRetry:u})));case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.find((function(e){return e.type===k.a.TEXT&&0===e.text.length}));return e.length>1&&t?e.filter((function(e){return e.type!==k.a.TEXT})):e}n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return j}))},447:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(0),c=n.n(i),u=n(175),l=n(69);function d(e){var t=e.spotId,n=e.messageDepth,r={spot_id:t,message_type:0===(void 0===n?0:n)?"comment":"reply",message_id:e.messageId};return Object(l.a)("conversation-read/message-ref",{method:"POST",data:r})}var p=n(44);function f(e){var t=e.spotId,n=e.postId,r=e.messageDepth,a={spot_id:t,entity_type:0===(void 0===r?0:r)?"comment":"reply",entity_id:e.messageId};return Object(p.a)("v1.0.0/share/message",{method:"POST",postId:n,data:a})}var m=n(32);n.d(t,"a",(function(){return g}));var v=c.a.get("tenant_config.shared.share_api_version",1);function g(e){return y.apply(this,arguments)}function y(){return(y=s()(a.a.mark((function e(t){var n,r,o,s,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.messageDepth,r=t.messageId,o=t.postId,1!==v){e.next=8;break}return e.next=4,d({spotId:m.A,messageDepth:n,messageId:r});case 4:s=e.sent,i=s.body.reference,e.next=12;break;case 8:return e.next=10,f({spotId:m.A,messageDepth:n,messageId:r,postId:o});case 10:s=e.sent,i=s.reference;case 12:return c=u.a.urls.share.replace("{REFERENCE_ID}",i),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(49),c=n(2),u=n(103);function l(e){var t,n,r=null!==(t=null==e?void 0:e.mode)&&void 0!==t?t:"signin",o=null!==(n=null==e?void 0:e.username)&&void 0!==n?n:"";return function(){var e=s()(a.a.mark((function e(t,n){var s,l,d,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{s=n(),l=s.currentUser,d=s.moduleOptions,p=d.shouldOpenLogin,f=d.isConnectEnabled,!p||!f||Object(i.d)(l)&&"signin"===r||Object(u.c)({mode:r,username:o})}catch(e){c.a.error("openLoginSelectorModal",e)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},65:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"l",(function(){return O})),n.d(t,"b",(function(){return E})),n.d(t,"k",(function(){return w})),n.d(t,"a",(function(){return _})),n.d(t,"j",(function(){return j})),n.d(t,"c",(function(){return x})),n.d(t,"i",(function(){return P})),n.d(t,"h",(function(){return D}));var r=n(21),a=n.n(r),o=n(29),s=n.n(o),i=n(22),c=n.n(i),u=n(44);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e){return f.apply(this,arguments)}function f(){return(f=c()(a.a.mark((function e(t){var n,r,o,s,i,c,u,l,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,o=t.postId,s=t.entities,i=t.contentType,c=t.displayName,u=t.tempMessageId,l=t.starsRating,e.next=3,D("".concat(i,"/").concat(r,"/comment"),{method:"POST",data:{content:s,metadata:d(d({},c?{display_name:c}:{}),{},{reply_to:{}}),temp_id:u,stars:l},postId:o});case 3:return p=e.sent,(f=null==p?void 0:p.message).users=null!==(n=null==f?void 0:f.users)&&void 0!==n?n:[],e.abrupt("return",{body:f});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=c()(a.a.mark((function e(t){var n,r,o,s,i,c,u,l,p,f,m,v,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,o=t.replyToMessageId,s=t.rootMessageId,i=t.entities,c=t.displayName,u=t.postId,l=t.contentType,p=t.tempMessageId,f=t.starsRating,m=o?{reply_id:o}:{},e.next=4,D("".concat(l,"/").concat(r,"/comment/").concat(s,"/reply"),{method:"POST",data:{content:i,metadata:d(d({},c?{display_name:c}:{}),{},{reply_to:m}),temp_id:p,stars:f},postId:u});case 4:return v=e.sent,(g=null==v?void 0:v.message).users=null!==(n=null==g?void 0:g.users)&&void 0!==n?n:[],e.abrupt("return",{body:g});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=c()(a.a.mark((function e(t){var n,r,o,s,i,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.messageId,o=t.entities,s=t.displayName,i=t.postId,c=t.starsRating,e.next=3,D("message/".concat(r),{method:"PATCH",data:{content:o,metadata:d(d({},s?{display_name:s}:{}),{},{reply_to:{}}),stars:c},postId:i});case 3:return u=e.sent,(l=null==u?void 0:u.message).users=null!==(n=null==l?void 0:l.users)&&void 0!==n?n:[],e.abrupt("return",{body:l});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return h.apply(this,arguments)}function h(){return(h=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D("message/".concat(t),{method:"DELETE",data:{},postId:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.abrupt("return",{body:{etag:0,messages_count:0,comments_count:0}});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function O(e,t){return I.apply(this,arguments)}function I(){return(I=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D("message/report",{method:"POST",data:{message_id:t},postId:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function E(e,t,n){return k.apply(this,arguments)}function k(){return(k=c()(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("block-user",{method:"POST",data:{user:t,source:"conversation",apply_to_history:r},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return C.apply(this,arguments)}function C(){return(C=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("block-user",{method:"DELETE",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return T.apply(this,arguments)}function T(){return(T=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("allow-user",{method:"POST",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return S.apply(this,arguments)}function S(){return(S=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("allow-user",{method:"DELETE",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return M.apply(this,arguments)}function M(){return(M=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("messages/approve",{method:"POST",data:t,postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return R.apply(this,arguments)}function R(){return(R=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("messages/block",{method:"POST",data:t,postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return Object(u.a)("v1.0.0/moderation/".concat(e),t)}},66:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(29),c=n.n(i),u=n(54),l=n.n(u),d=n(24),p=n.n(d),f=n(25),m=n.n(f),v=n(26),g=n.n(v),y=n(27),b=n.n(y),h=n(28),O=n.n(h),I=n(41),E=n.n(I),k=n(257),w=n.n(k),C=n(9),_=n.n(C),T=n(31),j=n.n(T),S=n(10),x=n.n(S),M=n(11),P=n(34),R=n.n(P),D=n(397),N=n(402),L=n.n(N),U=n(698),B=n.n(U),A=n(30),V=n(0),q=n.n(V),H=n(40),W=n(396),G=n(103),F=n(699),X=n.n(F),K=n(111),Q=n(64),J=n(700),z=n.n(J);function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var Z=function(e){g()(n,e);var t=Y(n);function n(){var e;p()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).userImageRef=_.a.createRef(),e}return m()(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.disableUserProfileModal,r=x()(z.a.faceItem,{[z.a.notClickable]:n});return _.a.createElement("div",{className:z.a.faceItem,key:t.id},_.a.createElement(K.b,{disableUserImageUpload:!0,className:r,size:30,disableOnlineIndicator:!0,user:t}))}}]),n}(C.Component);Z.defaultProps={openUserProfileModal:function(){},userNickName:null,spotId:null};var $=E()(Object(M.connect)((function(e){return{spotId:e.moduleOptions.spotId,token:e.authentication.token,enableSSO:e.moduleOptions.enableSSO,disableUserProfileModal:e.moduleOptions.disableUserProfileModal,disableProfileHover:e.moduleOptions.disableProfileHover}}),{onLogin:Q.a}),R()({}))(Z);function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var te=function(e){g()(n,e);var t=ee(n);function n(){return p()(this,n),t.apply(this,arguments)}return m()(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.avatars,n=e.avatars;if(this.props.width!==e.width)return!0;if(t.length!==n.length)return!0;var r=t.map((function(e){return e.id})),a=n.map((function(e){return e.id}));return r.filter((function(e){return!a.includes(e)})).length>0}},{key:"render",value:function(){var e=this.props,t=e.avatars,n=e.currentUserId,r=e.isLoggedIn,a=e.openUserProfileModal,o=e.reporterBadgeText,s=e.moderatorBadgeText,i=e.style,c=e.spotName;return _.a.createElement("div",{className:X.a.container},_.a.createElement("section",{style:i,className:X.a.facesList,"data-spot-im-class":"faces-list"},t.slice(0,20).map((function(e){var t=e.id===n;return _.a.createElement("div",{className:X.a.faceItemWrapper,key:e.id},_.a.createElement($,{user:e,imageId:e.imageId,isMe:t,isLoggedIn:r,spotName:c,openUserProfileModal:a,reporterBadgeText:o,moderatorBadgeText:s}))}))),_.a.createElement("svg",{className:X.a.faceSvgMask},_.a.createElement("defs",null,_.a.createElement("clipPath",{id:"faceItemMask"},_.a.createElement("path",{d:"M15,0 C19.9070141,0 24.2636994,2.35623795 27.0003635,5.99902151 C25.1161248,8.50617072 24,11.6227429 24,15 C24,18.3772571 25.1161248,21.4938293 26.9996365,24.0009785 C24.2636994,27.6437621 19.9070141,30 15,30 C6.71572875,30 0,23.2842712 0,15 C0,6.71572875 6.71572875,0 15,0 Z",id:"Combined-Shape"})))))}}]),n}(C.Component);te.defaultProps={avatars:[]};var ne=Object(M.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(te),re=n(92),ae=n(36),oe=n(49),se=n(162),ie=n(37),ce=n(701),ue=n.n(ce),le=function(e){var t=e.onClose,n=e.onImportClicked,r=Object(se.a)().t;return _.a.createElement("div",{className:ue.a.disqusWelcomeContainer,"data-spotim-class":"disqus-welcome-container"},_.a.createElement("span",{className:ue.a.icon},_.a.createElement(A.Icon,{name:"spotim-bubbles",type:"custom"})),_.a.createElement("div",{className:ue.a.textPlaceholder},_.a.createElement(A.Typography,{type:"h3",weight:"bold"},r("disqusWelcome.meetYourCommunity","Meet your new conversation!")),_.a.createElement(A.Typography,{type:"modalBody",className:ue.a.margin},r("disqusWelcome.importDisqusProfile","Create your new profile by importing your Disqus information")),_.a.createElement(A.Button,{mode:"primary",onClick:function(){return n({connectType:ie.connectTypes.DISQUS})}},r("disqusWelcome.importProfile","Import Profile"))),_.a.createElement(A.CloseButton,{onClick:t,className:ue.a.closeButton}))},de=n(702),pe=n.n(de),fe=n(23),me=n(33),ve=n(258),ge=n(218),ye=n(704),be=n.n(ye),he=n(50),Oe=n(104),Ie=n(705),Ee=n.n(Ie),ke=function(e){var t=e.children;return _.a.createElement("span",{className:Ee.a.wrapper},_.a.createElement("span",{className:Ee.a.normal},t),_.a.createElement("span",{className:Ee.a.strong},t))},we=n(449),Ce=q.a.get("tenant_config.communityView.reverseTabsOrder",!1),_e=function(e){var t=e.selectedCommunityView,n=e.handleTabClick;return _.a.createElement(_.a.Fragment,null,_.a.createElement(A.Button,{className:x()(be.a.tabButton,{[be.a.selected]:t===he.a.Explore}),onClick:function(){return n(he.a.Explore)}},_.a.createElement(A.Typography,{type:"product-heading",className:be.a.headerText},_.a.createElement(ke,null,_.a.createElement(me.a,{i18nKey:"inpage.header.explore"},"Explore")))),_.a.createElement("div",{className:be.a.marginVMd}))},Te=Object(M.connect)((function(e){var t=e.moduleOptions,n=e.conversation,r=t.isStarsRatingEnabled,a=t.textsOverrides,o=t.spotId,s=t.isConversationPage;return{isStarsRatingEnabled:r,conversationHeaderText:a.conversationHeaderText,starsRatingHeaderText:a.starsRatingHeaderText,isLiveBlog:ae.j(e),messagesCount:n.messagesCount,spotId:o,selectedCommunityView:ae.b(e),isConversationPage:s}}),(function(e){return{setCommunityView(t){e(Object(Oe.a)(t))},preloadConversation(){e({type:fe.S})}}}))((function(e){var t,n=e.isStarsRatingEnabled,r=e.isLiveBlog,a=e.conversationHeaderText,o=e.starsRatingHeaderText,s=e.messagesCount,i=void 0===s?0:s,c=e.selectedCommunityView,u=e.isConversationPage,l=e.setCommunityView,d=e.preloadConversation,p=Object(P.useTracking)();function f(e){l(e),p.trackEvent({type:"change-tab-clicked",item_type:e.toLowerCase()})}if(r)return null;var m=ve.a&&!r&&!u;return n?t=o||_.a.createElement(me.a,{i18nKey:"inpage.header.starsRating"}):a&&(t=a),_.a.createElement("div",{className:x()(be.a.headers,(ge.b===he.a.Conversation||Ce)&&be.a.reversed,!m&&be.a.singleTab),onMouseEnter:pe()(d)},m&&_.a.createElement(_e,{selectedCommunityView:c,handleTabClick:function(){return f(he.a.Explore)}}),_.a.createElement(we.a,{enableCommunityViewOptions:m,selectedCommunityView:c,handleTabClick:function(){return f(he.a.Conversation)},handleConversationHeaderGotFocus:function(){var e;null===(e=document.querySelector('[tabindex="2"]'))||void 0===e||e.focus()},headerText:t,messagesCount:i}))})),je=n(404),Se=n.n(je),xe=n(35),Me=n.n(xe),Pe=/\{\{linkValue\}\}/g,Re=/\{\{modalValue\}\}/g,De=function(e){var t=e.onModalLinkClick,n=e.title,r=n.value,a=n.linkValue,o=n.modalValue,s=n.linkUrl,i=null;function c(e,t){var n=(e||"").replace(Pe,"<a class=".concat("spcv_modal-link-text",' target="_blank" rel="noopener noreferrer" href="').concat(s,'">').concat(a,"</a>"));if(n.length)return _.a.createElement("span",{className:Se.a.modalLinkText,key:t,dangerouslySetInnerHTML:{__html:n}})}if(!r)return null;var u=r.split(Re),l=Me()(u,2),d=l[0],p=l[1],f=c(d,"1"),m=c(p,"3");return o&&(i=function(e,n){return _.a.createElement("a",{key:n,onClick:t,className:Se.a.modalLinkText},e)}(o,"2")),_.a.createElement(_.a.Fragment,null,[f,i,m].filter((function(e){return e})))},Ne=function(e){var t,n,r=e.onModalLinkClick,a=e.title,o=Object(se.a)("community-guidelines").t,s=a.value,i=a.key,c=a.modalValue,u=a.linkUrl,l=a.linkValue,d=o("".concat(i,".value"),s,{modalValue:"{{modalValue}}",linkUrl:"{{linkUrl}}",linkValue:"{{linkValue}}"});return c&&(t=o("".concat(i,".modalValue"),c)),l&&(n=o("".concat(i,".linkValue"),l)),_.a.createElement(De,{title:{value:d,modalValue:t,linkValue:n,linkUrl:u},onModalLinkClick:r})},Le=n(67),Ue=q.a.get("tenant_config.conversation.communityGuidelinesEnabled",!1),Be=q.a.get("tenant_config.conversation.communityGuidelinesTitle",{key:"defaultTitle.0",value:"Your voice matters. Discussions are moderated for civility."}),Ae=Object(M.connect)((function(e){return{postId:e.conversation.postId,isLiveBlog:ae.j(e)}}))((function(e){var t=e.isLiveBlog,n=e.postId,r=Object(P.useTracking)();function a(){r.trackEvent({type:"community-guidelines-clicked",item_type:"community-guidelines-page",target_type:"main"}),Object(Le.g)(n)}var o="CUSTOM"===(Ue&&Be&&Be.key?"DEFAULT":"CUSTOM")?_.a.createElement(De,{title:Be,onModalLinkClick:a}):_.a.createElement(Ne,{title:Be,onModalLinkClick:a});return Ue&&_.a.createElement(C.Fragment,null,!t&&_.a.createElement(A.Typography,{type:"product-sub-heading",className:Se.a.subheaderContainer},o))})),Ve=n(128);var qe=n(708),He=n.n(qe),We=n(1);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var Fe=q.a.get("tenant_config.conversation.communityGuidelinesEnabled"),Xe=q.a.get("tenant_config.conversation.disable_header_facelist",!1),Ke=function(e){g()(n,e);var t=Ge(n);function n(e){var r;return p()(this,n),(r=t.call(this,e)).headerRef=_.a.createRef(),r.openDiscusForumAccount=function(){Object(We.dispatchSpotimEvent)(Ve.d)},r.state={showDisqusHeader:q.a.get("tenant_config.conversation.show_disqus_header",!1)},r}return m()(n,[{key:"componentDidUpdate",value:function(){var e,t;this.props.scrollToHeader&&(!this.headerRef.current||(e=this.headerRef.current,(t=e.getBoundingClientRect()).top>=0&&t.top<window.innerHeight||t.top<0&&t.bottom>0)||(this.headerRef.current.scrollIntoView(),this.props.finishScrollToHeader()))}},{key:"render",value:function(){var e,t,n=this,r=this.state.showDisqusHeader,a=this.props,o=a.spotName,s=a.isLoggedIn,i=a.currentUserId,c=a.followers,u=a.useDisqusLogin,l=a.enableConversationHeaderFacesList,d=a.reporters,p=a.handleDisqusLogin,f=a.openUserProfileModal,m=a.reporterBadgeText,v=a.moderatorBadgeText,g=a.isLiveBlog,y=a.postId,b=a.isPostPage,h=a.isReadOnly;!s&&u&&(_.a.createElement(W.a,{onClick:p,postId:y}),t=!g&&r&&_.a.createElement(le,{onImportClicked:p,onClose:function(){return n.setState({showDisqusHeader:!1})}})),!Xe&&l&&(e=!H.a&&_.a.createElement(ne,{avatars:c,reporters:d,openUserProfileModal:f,spotName:o,reporterBadgeText:m,moderatorBadgeText:v,isLoggedIn:s,currentUserId:i}));var O=x()(He.a.conversationHeader,{[He.a.noFaces]:!l});return g||b?null:_.a.createElement("div",{ref:this.headerRef,className:O,"data-spot-im-class":"conversation-header"},t,_.a.createElement("div",{className:He.a.info},_.a.createElement("div",{className:He.a.leftArea},_.a.createElement("div",{className:He.a.titleFacesWrapper},_.a.createElement(Te,null),e),!h&&Fe&&_.a.createElement(Ae,null)),void 0))}}]),n}(_.a.Component);Ke.defaultProps={isMobileDevice:!1};var Qe=Object(M.connect)((function(e){var t=e.currentUser,n=e.conversation,r=e.followers,a=e.isReadOnly,o=e.moduleOptions,s=o.textsOverrides,i=o.useDisqusLogin,c=o.enableConversationHeaderFacesList,u=o.reporters,l=o.spotName,d=o.direction,p=o.isMobile,f=o.enableSSO,m=o.postId,v=ae.j(e),g=s.moderatorBadgeText,y=s.reporterBadgeText;return{spotName:l,enableConversationHeaderFacesList:c,direction:d,isLoggedIn:Object(oe.d)(t),currentUserId:t.id,messagesCount:n.messagesCount,isPostPage:n.contentType===he.b.Post,useDisqusLogin:i,followers:r,moderatorBadgeText:g,reporterBadgeText:y,reporters:u,isMobileDevice:H.a||p,isLiveBlog:v,currentUser:t,enableSSO:f,postId:m,scrollToHeader:ae.i(e),isReadOnly:a}}),(function(e){return{openUserProfileModal:function(t){return e(Object(re.a)(t))},handleDisqusLogin:G.a,finishScrollToHeader(){e(Object(Oe.c)(!1))}}}))(Ke),Je=n(405),ze=n(709),Ye=n.n(ze);function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var $e=function(e){g()(n,e);var t=Ze(n);function n(){return p()(this,n),t.apply(this,arguments)}return m()(n,[{key:"render",value:function(){var e=this.props,t=e.isModerator,n=e.onToggleHide,r=null;return t&&(r=_.a.createElement("div",null,_.a.createElement("span",null,_.a.createElement(me.a,{i18nKey:"inpage.hidden.text"}))," ",_.a.createElement("span",{className:Ye.a.link,onClick:n},_.a.createElement(me.a,{i18nKey:"inpage.hidden.button"}))," ")),r}}]),n}(C.Component);$e.displayName="HiddenConversationAlert",$e.propTypes={isModerator:j.a.bool.isRequired,onToggleHide:j.a.func};var et=Object(M.connect)((function(e){return{isModerator:e.currentUser.isModerator}}),(function(e){return{onToggleHide:function(){return e(Object(Je.a)())}}}))($e);var tt=n(710),nt=n(2),rt=n(711),at=n.n(rt),ot=function(e){return"string"==typeof e?at()(e):function e(t,n){var r;return Array.isArray(n)?n.map((function(n){return"string"==typeof n?n:e(t,n)})):"object"==typeof n&&null!==n?(r=Object.keys(n)).map((function(e){return t(e)})).reduce((function(a,o,s){var i,c;return i=n[r[s]],c=e(t,i),a[o]=c,a}),{}):n}(at.a,e)},st=n(407),it=n(123),ct=n(157),ut=n(158),lt=n(98),dt=function(){function e(){p()(this,e)}return m()(e,[{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.filterMine,t.filterConversationId),r=void 0===n?void 0:n;if(r){var a=e.conversation_id,o=e.conversationId,s=!(o=o||a)||r!==o;if(s)return!1}return!0}},{key:"execute",value:function(e,t,n){this.filter(e,t)&&n()}},{key:"isSentByMe",value:function(e){throw new Error("BaseRealtimeHandlers.isSentByMe should be implemented")}}]),e}(),pt=n(309),ft=n(362);function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var vt={};var gt,yt=function(e){g()(n,e);var t=mt(n);function n(e,r,a,o){var s;return p()(this,n),(s=t.call(this)).conversationId=e,s.realTime=r,s.dispatch=a,s.getState=o,s.subscribeOpts=void 0,s.execute=void 0,s.unsubscribeCallbacks=void 0,s.wrapWithTryCatch=function(e,t){return function(n){try{t(n)}catch(t){nt.a.error("wrapWithTryCatch",t,{handler:e})}}},s.picker=function(e){return e[s.conversationId]},s.subscribeOpts=[],s.unsubscribeCallbacks=[],s.registerEvents(),s}return m()(n,[{key:"isSentByMe",value:function(e){return function(e){return!!vt[e]}(e)}},{key:"getFilterOptions",value:function(){return{filterMine:!0,filterConversationId:this.conversationId}}},{key:"internalDispatch",value:function(e){this.dispatch(e)}},{key:"registerEvents",value:function(){var e=this;this.subscribeOpts.push({topic:"conversation/new-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/new-messages",(function(t){var n=e.getState();t.forEach((function(t){var r;t.user_id!==(null===(r=n.currentUser)||void 0===r?void 0:r.id)&&e.internalDispatch(Object(st.a)(t))}))}))}),this.subscribeOpts.push({topic:"conversation/count-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/count-messages",(function(t){var n=Me()(t,1)[0];e.internalDispatch({type:fe.Ab,payload:ot(n)})}))}),this.subscribeOpts.push({topic:"online/users",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("online/users",(function(t){e.internalDispatch(Object(pt.a)(t)),nt.a.send("fetch_online_users_faces_list")}))}),this.subscribeOpts.push({topic:"conversation/updated-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/updated-messages",(function(t){if(t&&t.length>0){var n=e.getState().reportedComments,r=t.filter((function(e){return(null==e?void 0:e.id)&&!n[null==e?void 0:e.id]}));e.internalDispatch(Object(it.b)(r))}}))}),this.subscribeOpts.push({topic:"conversation/deleted-messages",params:function(){return{conversation_id:e.conversationId,message_ids:[]}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/deleted-messages",(function(t){if(t.length>0){var n=e.getState(),r=n.currentUser,a=n.reportedComments,o=t.filter((function(e){return e.status===ie.statuses.BLOCKED})),s=t.filter((function(e){return(null==e?void 0:e.id)&&e.user_id!==(null==r?void 0:r.id)&&!a[null==e?void 0:e.id]&&"deleted"===e.status}));o.length>0&&e.internalDispatch(Object(ut.b)(o)),s.length>0&&e.internalDispatch(Object(ct.b)(s))}}))}),this.subscribeOpts.push({topic:"conversation/typing-v2-users",params:function(){return{conversation_id:e.conversationId,message_ids:[]}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/typing-v2-users",(function(t){var n=e.getState().currentUser;e.internalDispatch(Object(lt.f)(e.conversationId,t.map((function(e){return{messageId:null==e?void 0:e.key,count:null==e?void 0:e.count,users:null==e?void 0:e.users}})),n.id)),nt.a.send("typing_v2_users",{tags:{typingsCount:String(t.length)}})}))}),this.subscribeOpts.push({topic:"conversation/notifications-count",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/notifications-count",(function(t){var n=Me()(t,1)[0];e.internalDispatch(Object(ft.a)(null==n?void 0:n.unseen))}))}),this.subscribeOpts.forEach((function(t){var n=e.realTime.subscribe(t);e.unsubscribeCallbacks.push(n)}))}},{key:"unsubscribeEvents",value:function(){this.unsubscribeCallbacks.forEach((function(e){e()}))}}]),n}(dt),bt=n(32);function ht(e,t,n){var r=n().conversation,a={"x-spot-id":bt.A,"x-post-id":r.postId};try{var o=new tt.a({url:"v1.0.0/conversation/realtime/read",timeout:parseInt(q.a.get("tenant_config.realtime.start_timeout_milliseconds",3e4),10),requestParams:{headers:a}});e&&(gt=new yt(e,o,t,n))}catch(e){nt.a.error("subscribeRealtime",e)}}function Ot(e){try{e&&gt.unsubscribeEvents()}catch(e){nt.a.error("unsubscribeRealtime",e)}}var It=n(91),Et=n(446);var kt={show:function(){},values:{RANK:5,NEW_MESSAGE:20}},wt=n(447),Ct=function(){function e(){p()(this,e)}return m()(e,[{key:"subscribe",value:function(e,t){document.addEventListener(e,t)}},{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new CustomEvent(e,{detail:t});document.dispatchEvent(n)}},{key:"unsubscribe",value:function(e,t){document.removeEventListener(e,t)}}]),e}();var _t=n(178),Tt=n(13),jt=n(408);function St(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}var xt=function(e){g()(n,e);var t=St(n);function n(){return p()(this,n),t.apply(this,arguments)}return m()(n,[{key:"render",value:function(){var e=this.props,t=e.isModerator,n=e.postId,r=e.isLiveBlog,a=e.allowLogin,o=e.onLogin;return _.a.createElement(jt.a,{isModerator:t,postId:n,isLiveBlog:r,allowLogin:a,onLogin:o,hasFeedback:!0})}}]),n}(C.Component);xt.displayName="ConversationFooter";var Mt=Object(M.connect)((function(e){return{postId:e.moduleOptions.postId,isLiveBlog:ae.j(e),allowLogin:!Object(Tt.isLoggedIn)(e.currentUser)&&(e.moduleOptions.isConnectEnabled&&!e.moduleOptions.enableSSO||bt.r)}}),(function(e){return{onLogin(){e(Object(Q.a)())}}}))(xt),Pt=n(174),Rt=n(45),Dt=n(730),Nt=n.n(Dt),Lt=function(e){var t=e.text,n=e.iconSelector,r=e.buttonText,a=e.onClose,o=e.onBannerButtonClick;return _.a.createElement("div",{className:Nt.a.Banner},_.a.createElement(A.CloseButton,{className:Nt.a.BannerCloseButton,onClick:a}),_.a.createElement("div",{className:Nt.a.BannerContentWrapper},_.a.createElement(Rt.a,{className:Nt.a.BannerIcon,selector:n}),_.a.createElement(A.Typography,{className:Nt.a.BannerText,type:"body"},t," ",_.a.createElement(A.Button,{mode:"link",className:Nt.a.BannerButton,onClick:o},r))))},Ut=function(e){return e.startsWith("conversation")},Bt=function(e){if(e.hasOwnProperty("entities")&&Array.isArray(e.entities)&&Object(ie.hasText)(e)){var t=(new Date).getTime();return!(e.expiresIn&&t-(null==e?void 0:e.expiresIn)>=0)}return!1},At=n(410),Vt=n(42),qt=n(411),Ht=n(268),Wt=n(259),Gt=n(367),Ft=n(363),Xt=n(220),Kt=n(412),Qt=n(732),Jt=n.n(Qt),zt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value;return t&&_.a.createElement("span",{"data-spot-im-class":"community-question",className:Jt.a.communityQuestion},t)},Yt=n(733),Zt=n.n(Yt),$t=(n(734),n(735),n(171)),en={backgroundColor:"#f2f2f2",foregroundColor:"#e3e3e3"},tn={backgroundColor:"#7b7f83",foregroundColor:"#b3b3b3"},nn=function(e){var t=e.isDarkMode,n=e.isLTR;return _.a.createElement("div",{id:bt.b,style:{width:"100%",maxHeight:370}},_.a.createElement($t.a,l()({rtl:!n,speed:2,width:"100%"},t?tn:en),_.a.createElement("rect",{x:"88",y:"33",rx:"6",ry:"6",width:"60%",height:"54"}),_.a.createElement("rect",{x:"88",y:"113",rx:"6",ry:"6",width:"60%",height:"13"}),_.a.createElement("rect",{x:"88",y:"135",rx:"6",ry:"6",width:"45%",height:"13"}),_.a.createElement("circle",{cx:"51",cy:"59",r:"21"}),_.a.createElement("circle",{cx:"51",cy:"128",r:"21"}),_.a.createElement("rect",{x:"30",y:"172",rx:"6",ry:"6",width:"80%",height:"15"}),_.a.createElement("rect",{x:"30",y:"203",rx:"6",ry:"6",width:"80%",height:"15"})))};function rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rn(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function on(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O()(e);if(t){var a=O()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return b()(this,n)}}n.d(t,"c",(function(){return cn})),n.d(t,"b",(function(){return un}));var sn,cn=q.a.get("tenant_config.conversation.isUseShadowDomOnOverlays",!0),un=q.a.get("tenant_config.conversation.isUseShadowDomOnMain",!0),ln=q.a.get("tenant_config.conversation.enable_explore_onboarding",!0);!function(e){e.START="start",e.CENTER="center"}(sn||(sn={}));var dn=q.a.get("tenant_config.conversation.explore_mode_alignment",sn.START),pn=n(413),fn=L()((function(){return Promise.all([n.e(0),n.e(3),n.e(4),n.e(5),n.e(10),n.e(11),n.e(12),n.e(16),n.e(17),n.e(80),n.e(2),n.e(1),n.e(6),n.e(7),n.e(8),n.e(9),n.e(14),n.e(13),n.e(15),n.e(21),n.e(49)]).then(n.bind(null,897))}));var mn=function(e){g()(n,e);var t=on(n);function n(){var e;p()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).isInitialLoadComplete=!1,e.el=void 0,e.tabModeEvent=void 0,e.DocumentEventPubSub=new Ct,e.viewedOnce=!1,e.state={hasError:!1,errorDetails:{stack:"",message:""},remountHideAll:!1,isBannerVisible:ve.a},e.conversationRef=_.a.createRef(),e.handleViewportEnter=function(){if(!e.viewedOnce){e.viewedOnce=!0;var t={type:"viewed"};e.isCommunityViewEnabled()&&Object.assign(t,{item_type:e.props.selectedCommunityView.toLowerCase()});var n=e.getCommunityQuestion();n&&Object.assign(t,{taxonomy_subject:n}),nt.a.send("viewed"),e.props.tracking.trackEvent(t),e.props.container.style.minHeight="auto"}},e.resizeHandler=function(){var t=e.props.calculateIsMobile;t(e.el),window.addEventListener("resize",w()((function(){return t(e.el)}),200),!1)},e.handleTabModeActivation=function(t){9===t.keyCode&&(document.body.classList.add(pn.tabMode),e.tabModeEvent.activated||(e.tabModeEvent.activated=!0,document.dispatchEvent(e.tabModeEvent)))},e.handleTabModeDeactivation=function(){document.body.classList.remove(pn.tabMode),e.tabModeEvent.activated&&(e.tabModeEvent.activated=!1,document.dispatchEvent(e.tabModeEvent))},e.unmuteUser=function(t){var n=t.detail;(0,e.props.unmuteUser)(n&&n.userId)},e.handleErrorBoxReload=function(){e.setState({hasError:!1})},e.handleRemount=function(){e.setState({remountHideAll:!0},(function(){setTimeout((function(){e.setState({remountHideAll:!1})}),500)}))},e.deleteExploreBanner=function(){window.localStorage&&window.localStorage.setItem("SPOTIM_IS_EXPLORE_ONBOARDING_VIEWED","true"),e.setState({isBannerVisible:!1})},e.onBannerClose=function(){e.setState({isBannerVisible:!1}),e.deleteExploreBanner()},e.openExploreOnboarding=function(){var t,n,r;null===(t=window)||void 0===t||null===(n=t.__OPEN_WEB__)||void 0===n||null===(r=n.renderExploreOnboardingModal)||void 0===r||r.call(n),e.deleteExploreBanner()},e.getConversationBody=function(t,n,r,a,o,s){if(t===he.c.ERROR){var i=e.props.retryConversationRead;return _.a.createElement(qt.a,{onClick:i})}return t===he.c.FETCHING?_.a.createElement(nn,{isDarkMode:Object(At.a)(),isLTR:bt.w}):_.a.createElement(_.a.Suspense,{fallback:_.a.createElement(nn,{isDarkMode:Object(At.a)(),isLTR:bt.w})},_.a.createElement(fn,l()({ref:e.conversationRef,conversation:n,summaryWidget:r,pagination:a,comments:o,tracking:s},{onRemount:e.handleRemount})))},e}return m()(n,[{key:"getChildContext",value:function(){return{toastMessage:kt,getMessageShareUrl:wt.a}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.conversation,r=t.onConversationChange,a=e.conversation;this.isInitialLoadComplete||(this.isInitialLoadComplete=!0),a.id!==n.id&&r({prevConversationId:n.id,nextConversationId:a.id})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.enableAccessibilityColorContrast,n=e.conversation,r=e.scrollToComments,a=e.onConversationLoad,o=e.onScrollToConversation,s=n.id;!function(){var e=localStorage.getItem("SPOTIM_DRAFT_MESSAGE_V2");if(e)try{for(var t=JSON.parse(e),n=0,r=Object.entries(t);n<r.length;n++){var a=Me()(r[n],2),o=a[0],s=a[1];Ut(o)&&!Bt(s)&&delete t[o]}localStorage.setItem("SPOTIM_DRAFT_MESSAGE_V2",JSON.stringify(t))}catch(e){nt.a.error("clearExpiredDraftMessages",e)}}();var i=window.localStorage&&"true"!==window.localStorage.getItem("SPOTIM_IS_EXPLORE_ONBOARDING_VIEWED");this.setState({isBannerVisible:ve.a&&i}),a(s),r&&o({conversationId:s}),this.resizeHandler(),!0===t&&document.body.classList.add(pn.accessibilityMode),this.DocumentEventPubSub.subscribe("keydown",this.handleTabModeActivation),this.DocumentEventPubSub.subscribe("mousedown",this.handleTabModeDeactivation),this.tabModeEvent=document.createEvent("Event"),this.tabModeEvent.initEvent("tabModeChanged",!0,!0),this.tabModeEvent.activated=!1,this.el&&this.el.classList.add("spot-im-conversation-module"),bt.u&&this.DocumentEventPubSub.subscribe("data-spot-im-unmute-user",this.unmuteUser),this.setMethodsOnWindow()}},{key:"getCommunityQuestion",value:function(){var e=this.props,t=e.conversation;return e.communityQuestion||t.communityQuestion}},{key:"setMethodsOnWindow",value:function(){var e,t=this;this.props.isConversationPage||(window.__SPOTIM__=an(an({},window.__SPOTIM__),{},{createMessage:(e=s()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preloadConversation(),e.next=3,t.props.createMessage(n);case 3:t.props.setCommunityView(he.a.Conversation);case 4:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),switchTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.props.setCommunityView(he.a.Conversation),t.props.scrollToHeader(),e.focusSayControl&&t.props.focusSayControlOnSwitchTab()},preloadConversation:function(){t.preloadConversation()}}))}},{key:"componentDidCatch",value:function(e){throw new Error(e)}},{key:"componentDidUpdate",value:function(e){e.conversation.id!==this.props.conversation.id&&this.notifyConversationLoaded(),this.props.preloadConversation&&this.preloadConversation()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.conversation;(0,e.onConversationUnload)(t.id),this.DocumentEventPubSub.unsubscribe("keydown",this.handleTabModeActivation),this.DocumentEventPubSub.unsubscribe("mousedown",this.handleTabModeDeactivation),bt.u&&this.DocumentEventPubSub.unsubscribe("data-spot-im-unmute-user",this.unmuteUser)}},{key:"preloadConversation",value:function(){fn.preload()}},{key:"notifyConversationLoaded",value:function(){var e=this.props,t=e.conversation,n=e.isStarsRatingEnabled,r=e.currentUser,a=(e.postId,e.isLiveBlog),o=t.spotId,s=t.id;Object(We.dispatchSpotimEvent)(Vt.j,{spotId:o,conversationId:s});var i=document.querySelectorAll("".concat(bt.d,",\n      ").concat(bt.e)),c=i.length>0?i[0].offsetWidth:0,u={total_comments:t.messagesCount,in_view:Object(_t.b)().toString(),is_rating:n,avg_rate:t.averageStarsRating,is_registered:r.isRegistered,row:c};nt.a.send("".concat(a?"live_blog_":"","loaded")),this.props.tracking.trackEvent(an(an({},u),{},{type:"loaded"}))}},{key:"isCommunityViewEnabled",value:function(){var e=this.props,t=e.isConversationPage,n=e.isLiveBlog;return ve.a&&!n&&!t}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.conversation,a=n.summaryWidget,o=n.pagination,s=n.comments,i=n.currentUser,c=n.direction,u=n.selectedCommunityView,l=this.state.isBannerVisible,d=this.props.communityQuestion||r.communityQuestion;if(this.state.hasError,this.state.remountHideAll,r.isHidden)e=_.a.createElement(et,{conversation:r});else{var p=this.props,f=p.hideNonReadOnlyElements,m=p.isMobile,v=p.isLiveBlog,g=p.tracking,y=p.conversationStatus,b=this.isCommunityViewEnabled(),h=b&&dn===sn.CENTER,O=!!window.MSInputMethodContext&&!!document.documentMode,I=x()(Zt.a.conversationView,{[Zt.a.liveBlog]:v,[Zt.a.rtl]:"rtl"===c,"read-only":f,[Zt.a.hiddenConversation]:r.isHidden,[Zt.a.mqMobile]:m,[Zt.a.ie11]:O,[Zt.a.alignToCenter]:h,[Zt.a.communityView]:b},pn.conversationModule);e=_.a.createElement("div",{"data-spmark":"conversation conversation-id:".concat(r.id),className:I,"data-spot-im-class":"conversation-root","data-tooltips-boundaries":!0,ref:function(e){t.el=e},"data-is-logged-in":!!Object(oe.d)(i)},ln&&b&&l&&_.a.createElement(Lt,{text:_.a.createElement(me.a,{i18nKey:"onboarding.description"},"Welcome to your new community feed! Check out your upgraded and improved experience."),iconSelector:"onboardingNew",buttonText:_.a.createElement(me.a,{i18nKey:"onboarding.buttonText"},"Tell me more"),onClose:this.onBannerClose,onBannerButtonClick:this.openExploreOnboarding}),!bt.z&&_.a.createElement(Qe,null),(!b||u===he.a.Conversation)&&_.a.createElement(_.a.Fragment,null,d&&_.a.createElement(zt,{value:d}),this.getConversationBody(y,r,a,o,s,g)),b&&_.a.createElement("div",{"data-post-id":this.props.postId,"data-spot-im-module":"feed","data-spotim-module":"feed","data-spot-im-active":u===he.a.Explore}),_.a.createElement(Mt,{isModerator:i.isModerator}),_.a.createElement("div",{id:"tooltip-section"}))}return _.a.createElement(A.StylingWrapper,{isLtr:"ltr"===c},_.a.createElement(B.a,{onEnter:this.handleViewportEnter},_.a.createElement(Kt.ToastProvider,null,_.a.createElement("div",{id:"spotim-specific-conversation",className:Zt.a.mainContainer,"data-spotim-app":"conversation",style:{display:"none"}},e))))}}]),n}(C.Component);mn.childContextTypes={toastMessage:j.a.object.isRequired,getMessageShareUrl:j.a.func.isRequired},mn.defaultProps={isLiveBlog:!1};t.a=E()(Object(M.connect)((function(e){var t,n=e.currentUser,r=e.moduleOptions,a=e.comments,o=e.conversation,s=e.summaryWidget,i=e.appState.conversationStatus,c=r.enableAccessibilityColorContrast,u=r.testGroup,l=r.isConversationPage,d=r.contentType,p=ae.j(e);return{enableAccessibilityColorContrast:c,testGroup:u,hideNonReadOnlyElements:(t={isLiveBlog:p},t.isLiveBlog?q.a.get("tenant_config.live-blog.is_read_only_mode",!1):q.a.get("tenant_config.conversation.is_read_only_mode",!1)),isMobile:ae.l(e),brandColor:r.brandColor,conversationSkin:r.conversationSkin,spotId:r.spotId,postId:r.postId,isLiveBlog:p,direction:r.direction,conversation:o,pagination:a.pagination,comments:a.list,scrollToComments:r.scrollToComments,communityQuestion:r.communityQuestion,isStarsRatingEnabled:r.isStarsRatingEnabled,summaryWidget:s,currentUser:n,selectedCommunityView:ae.b(e),preloadConversation:ae.g(e),isConversationPage:l,contentType:d,conversationStatus:i}}),(function(e){return{calculateIsMobile:function(t){return e(Et.b(t))},onScrollToConversation:function(t){var n=t.conversationId;return e({type:"SCROLL_TO_CONVERSATION",payload:{conversationId:{conversationId:n}.conversationId}})},onConversationLoad:function(t){return e(function(e){return function(t,n){ht(e,t,n)}}(t))},onConversationUnload:function(t){return e(function(e){return function(){Ot(e)}}(t))},onConversationChange:function(t){var n=t.prevConversationId,r=t.nextConversationId;return e(function(e){var t=e.prevConversationId,n=e.nextConversationId;return function(e,r){Ot(t),ht(n,e,r)}}({prevConversationId:n,nextConversationId:r}))},unmuteUser:function(t){return e(function(e){return function(t){t({type:fe.zb,payload:{userId:e}})}}(t))},createMessage:function(t){return e(Object(Pt.a)(t))},setCommunityView(t){e(Object(Oe.a)(t))},focusSayControlOnSwitchTab(){e(Object(Oe.b)(!0))},scrollToHeader(){e(Object(Oe.c)(!0))},retryConversationRead(){e(function(){var e=s()(a.a.mark((function e(t,n){var r,o,s,i,c,u,l,d,p,f,m,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(),o=Object(ae.j)(r),s=r.moduleOptions,i=r.conversation,c=s.postId,u=s.elementId,l=s.isConversationPage,d=i.contentType,p=Object(Wt.b)(u)){e.next=8;break}return e.abrupt("return");case 8:t(Object(Xt.a)({conversationStatus:he.c.FETCHING})),m="true"===(null==p?void 0:p.getAttribute(bt.f)),v=new Promise((function(e){f=setTimeout((function(){e(!1)}),bt.c)})),Promise.race([v,Object(Ht.a)({postId:c,element:p,isPreview:m,isLiveBlog:o})]).then((function(e){if(!e||!e.data)return nt.a.error("conversation failed to load",new Error("read failed")),void t(Object(Xt.a)({conversationStatus:he.c.ERROR}));clearTimeout(f);var n=e.data;t(Object(Ft.a)({data:n,postId:c,contentType:d})),Object(Gt.a)(l)&&t(Object(Oe.a)(he.a.Conversation,!1))})).catch((function(e){nt.a.error("conversation failed to load",e),t(Object(Xt.a)({conversationStatus:he.c.ERROR}))}));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}})),R()((function(e){var t="conversation";return e.isConversationPage&&(t=e.contentType===he.b.Post?"post-page":"conversation-page"),{source:t,total_comments:e.conversation.messagesCount,is_rating:e.isStarsRatingEnabled,avg_rate:e.conversation.starRatingSummary&&e.conversation.starRatingSummary.average,is_registered:e.currentUser.isRegistered,post_id:e.postId,spot_id:e.spotId,user_id:e.currentUser.id}}),{dispatch:It.analyticsTrack}),Object(D.a)())(mn)},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(54),a=n.n(r),o=n(52),s=n.n(o),i=n(30),c=n(9),u=n.n(c),l=n(10),d=n.n(l),p=n(673),f=n.n(p),m=function(e){var t=e.disableHover,n=e.weight,r=e.isIcon,o=e.circleIcon,c=e.className,l=e.children,p=s()(e,["disableHover","weight","isIcon","circleIcon","className","children"]);return u.a.createElement(i.Typography,a()({},p,{type:"action",className:d()(f.a.actionWrapper,{[f.a.hoverBackground]:!t,[f.a.icon]:r,[f.a.circleIcon]:o},c),weight:n}),l)}},92:function(e,t,n){"use strict";var r=n(21),a=n.n(r),o=n(22),s=n.n(o),i=n(35),c=n.n(i),u=n(17),l=n.n(u),d=n(0),p=n.n(d),f=n(2),m=n(403),v=!1;var g=function(e){f.a.apm.start("user_profile_mount"),new Promise((function(e){if(v)e();else{var t=(p.a.get("assets_config")||[]).find((function(e){if(e.variant){var t,n=e.variant.split(":"),r=c()(n,2),a=r[0],o=r[1],s=null!==(t=l.a.getVariant(a))&&void 0!==t?t:"A";return"modals"===e.module&&"user profile bundle"===e.name&&s===o}return"modals"===e.module&&"user profile bundle"===e.name}));t?(document.addEventListener("spot-im-user-profile-initialized",(function(){v=!0,e()})),Object(m.a)(document.body,"".concat(t.url)).catch((function(e){return f.a.error("fetchUserProfile",e)}))):console.warn('Error: cannot find "user profile bundle" in `assets_config`')}})).then((function(){window.mountUserProfile(e),f.a.apm.end("user_profile_mount")})).catch((function(e){f.a.error("fetchAndMountUserProfile",e)}))},y=n(69),b=n(68);function h(e){return O.apply(this,arguments)}function O(){return(O=s()(a.a.mark((function e(t){var n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,e.next=3,Object(y.a)("public-user/external-user/".concat(n),{data:{}});case 3:return r=e.sent,o=r.body,e.abrupt("return",b.a.map(o,{display_name:"displayName",image_url:"imageUrl",encrypted_pkey:"encryptedPKey",user_name:"username"}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=n(42),E=n(1);function k(e){return function(){var t=s()(a.a.mark((function t(n,r){var o,s,i,c,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=r().moduleOptions.useExternalUserId,s=e.displayName,i=e.id,c=e.username,u=e.userId,l={id:i,displayName:s,username:c,userId:u},!o){t.next=8;break}return t.next=7,h({userId:i});case 7:l=t.sent;case 8:Object(E.dispatchSpotimEvent)(I.o,l),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),f.a.error("notifyOpenUserProfile",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}()}function w(e){var t=function(e){return e instanceof Array?(console.warn("OpenUserProfileModal: should pass new object arguments"),{user:e[0],overrideDisplayName:e[1],overrideImageId:e[2],mode:e[3]}):e}(e),n=t.user,r=t.overrideDisplayName,o=t.mode;return n&&n.id||f.a.error("openUserProfileModal","no user provided"),function(){var e=s()(a.a.mark((function e(t,s){var i,c,u,l,d,p,f,m,v,y,b,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=s(),c=i.authentication.token,u=i.moduleOptions,l=u.disableUserProfileModal,d=u.mainLanguage,p=u.postId,f=u.spotId,m=u.brandColor,v=u.direction,y=u.enableSSO,b=u.editableSSO,h=i.currentUser,"main"===o&&t(k(n)),l&&"privacy"!==o||g({user:n,isDisableNavigation:"privacy"===o&&l,currentUser:h,mode:o,locale:d,postId:p,spotId:f,brandColor:m,direction:v,token:c,enableSSO:y,canEditProfile:!y,canEditUserImage:!y||b,overrideDisplayName:r});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}n.d(t,"a",(function(){return w}))}}]);
//# sourceMappingURL=conversation-component~feedback-modal~preRender-bundle.js.map