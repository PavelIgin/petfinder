(window.webpackJsonp_spotim_4006192861=window.webpackJsonp_spotim_4006192861||[]).push([[5],{398:function(t,n,e){"use strict";e.r(n),function(t){e.d(n,"createTracker",(function(){return A})),e.d(n,"preparePayload",(function(){return N})),e.d(n,"trackEvent",(function(){return T})),e.d(n,"trackEventFactory",(function(){return M}));var i=e(17),r=e.n(i),o=e(0),a=e.n(o),s=e(184),c=e(678),u=e.n(c),d=e(1);function l(){return(l=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}).apply(this,arguments)}function v(){var t=localStorage.getItem("SPOTIM_DEVICE_UUID_V2");return t?JSON.parse(t):{}}function f(){return"."+function(t){void 0===t&&(t="");var n=(t=t.replace(/^www\./,"")).split(/\./);if(3===n.length){var e=n[2],i=n[1],r=p.includes(e),o=!p.includes(i)&&!g.includes(i);if(r&&o)return n.shift(),n.join(".")}for(;n.length>3;)n.shift();3===n.length&&(n[1].length>2&&n[2].length>2||-1===g.indexOf(n[1])&&-1===p.indexOf(n[2]))&&n.shift();return n.join(".")}(document.domain)}var p="ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|be|bf|bg|bh|bi|bj|bm|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|cl|cm|cn|co|cr|cu|cv|cw|cx|cz|de|dj|dk|dm|do|dz|ec|ee|eg|es|et|eu|fi|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|im|in|io|iq|ir|is|it|je|jo|jp|kg|ki|km|kn|kp|kr|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|na|nc|ne|nf|ng|nl|no|nr|nu|nz|om|pa|pe|pf|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|yt".split("|"),g="com|edu|gov|net|mil|org|nom|sch|caa|res|off|gob|int|tur|ip6|uri|urn|asn|act|nsw|qld|tas|vic|pro|biz|adm|adv|agr|arq|art|ato|bio|bmd|cim|cng|cnt|ecn|eco|emp|eng|esp|etc|eti|far|fnd|fot|fst|g12|ggf|imb|ind|inf|jor|jus|leg|lel|mat|med|mus|not|ntr|odo|ppg|psc|psi|qsl|rec|slg|srv|teo|tmp|trd|vet|zlg|web|ltd|sld|pol|fin|k12|lib|pri|aip|fie|eun|sci|prd|cci|pvt|mod|idv|rel|sex|gen|nic|abr|bas|cal|cam|emr|fvg|laz|lig|lom|mar|mol|pmn|pug|sar|sic|taa|tos|umb|vao|vda|ven|mie|北海道|和歌山|神奈川|鹿児島|ass|rep|tra|per|ngo|soc|grp|plc|its|air|and|bus|can|ddr|jfk|mad|nrw|nyc|ski|spy|tcm|ulm|usa|war|fhs|vgs|dep|eid|fet|fla|flå|gol|hof|hol|sel|vik|cri|iwi|ing|abo|fam|gok|gon|gop|gos|aid|atm|gsm|sos|elk|waw|est|aca|bar|cpa|jur|law|sec|plo|www|bir|cbg|jar|khv|msk|nov|nsk|ptz|rnd|spb|stv|tom|tsk|udm|vrn|cmw|kms|nkz|snz|pub|fhv|red|ens|nat|rns|rnu|bbs|tel|bel|kep|nhs|dni|fed|isa|nsn|gub|e12|tec|орг|обр|упр|alt|nis|jpn|mex|ath|iki|nid|gda|inc".split("|");var m,h=new Date,_=function(){if(I(new Date,h)<10&&"object"==typeof m){var t=m;return{visitId:t.visitId,duration:t.duration}}var n=function(){var t=u.a.get("spotim_visitId");try{return JSON.parse(t)}catch(t){return null}}(),e=n.visitId,i=n.creationDate,r=b(30),o=I(new Date,new Date(i)),a={visitId:e,creationDate:i,duration:Math.floor(o)};return h=new Date,m=a,u.a.set("spotim_visitId",a,{expires:r,domain:f()}),{visitId:e,duration:a.duration}},w=function(){var t={visitId:v().uuid,creationDate:new Date,duration:0},n=JSON.stringify(t),e=b(30);return u.a.set("spotim_visitId",n,{expires:e,domain:f()}),{visitId:t.visitId,duration:t.duration}},b=function(t){return new Date((new Date).getTime()+60*t*1e3)},I=function(t,n){var e=(t.getTime()-n.getTime())/1e3,i=Math.abs(e);return Math.round(i)};function k(){return window.__SPOTIM_PAGE_VIEW_ID__||(window.__SPOTIM_PAGE_VIEW_ID__=v().uuid),window.__SPOTIM_PAGE_VIEW_ID__||""}function E(t){void 0===t&&(t={});var n={};return Object.keys(t).forEach((function(e){null!==t[e]&&void 0!==t[e]&&(n[e]=t[e])})),encodeURIComponent(btoa(JSON.stringify(n)))}function S(){var t;try{t=JSON.parse(localStorage.getItem("SPOTIM_CURRENT_USER")||"").data.id}catch(t){}return t}function y(){if(!window.$$SPOTIM_BID$$){var t=v().uuid;window.$$SPOTIM_BID$$=t}return window.$$SPOTIM_BID$$}var O=function(){var t=!0===function(){var t=u.a.get("spotim_visitId");if(!(void 0!==t))return!1;try{return JSON.parse(t),!0}catch(t){return!1}}()?_():w(),n=t.visitId,e=t.duration;return window.$$SPOTIM_VID$$=n,{visitId:n,duration:e}},x=function(t){var n,e;void 0===t&&(t={});var i=null!==(n=null===(e=window.__OPEN_WEB__)||void 0===e?void 0:e.customPublisherData)&&void 0!==n?n:{};return JSON.stringify(l({},i,t))};function P(){var t=function(){if(performance&&performance.timing){var t=performance.timing.domLoading;if(!isNaN(t)&&t>0)return t}return null}();if(t&&t>=0&&!isNaN(t)){var n=Date.now()-t;return isNaN(n)||n<0||n>Number.MAX_SAFE_INTEGER?null:n}return null}var D={development:"http://127.0.0.1:8000/api/v1/pixels",staging:"https://pix.staging-spot.im/api/v1/pixels",production:"https://pix.spot.im/api/v1/pixels"},j=function(){function n(n){this.configProvider=n,this.events=[],this.url="",this.maxEvents=10,Object(s.a)("EventsCollector",t.env.PACKAGE_VERSION),this.url=D[this.configProvider.get("env","production")],this.maxEvents=this.configProvider.get("tenant_config.events-collector.max_events",10),this.startSendingEvents(),this.handleUnload()}n.getInstance=function(t){var e=window.__SPOTIM__.SERVICES.events;return e||(e=new n(t),window.__SPOTIM__.SERVICES.events=e),e};var e=n.prototype;return e.startSendingEvents=function(){var t=this,n=this.configProvider.get("tenant_config.events-collector.time_interval_milliseconds",1e4);this.intervalId=setInterval((function(){t.sendEvents()}),n)},e.sendEvents=function(){if(this.events.length>0){var t=this.events.join("\\n");this.sendBeacon(t)}},e.sendBeacon=function(t){"sendBeacon"in navigator?navigator.sendBeacon(this.url,t)&&this.clean():(fetch(this.url,{method:"POST",body:t}),this.clean())},e.addEvent=function(t){var n=E(t);this.events.push(n),this.events.length>this.maxEvents&&this.sendEvents()},e.handleUnload=function(){var t=this;window.addEventListener("unload",(function(){t.sendEvents()}))},e.clean=function(){this.events=[]},e.stopSendingEvents=function(){clearInterval(this.intervalId)},n}().getInstance(a.a);function C(t,n){var e;if(void 0===n&&(n=!1),n){var i,r=function(t){return void 0===t&&(t={}),"https://pix.spot.im/api/v1/pixel?m="+E(t)+"&rnd="+Math.random()}(t);e=fetch(r,{credentials:"include",headers:(i={},i["x-spotim-device-uuid"]=v().uuid,i["x-spotim-page-view-id"]=k(),i)})}else j.addEvent(t);return e||Promise.resolve({})}function N(t){var n,e=v().uuid,i=O(),o=i.visitId,a=i.duration,s=Object(d.getLocation)(),c=t.publisher_custom_data_override,u=function(t,n){if(null==t)return{};var e,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)e=o[i],n.indexOf(e)>=0||(r[e]=t[e]);return r}(t,["publisher_custom_data_override"]);return l({page_view_id:k(),guid:e,referrer:(n=document.referrer,n&&n.trim()?n.replace(/′/g,"'").replace(/’/g,"'"):""),user_id:S()||"0",ib_browser_id:y(),visit_id:o,duration:a,v:10,domain:s.hostname,url:s.href,lang:navigator.userLanguage||navigator.language,uid:e,source_version:"",time_delta:P()||0,test_field:r.a.getAllExperiments(),split_name:r.a.getActiveExperiments(),publisher_custom_data:x(c)},u)}function T(t){var n,e,i=N(t);return"*"===localStorage.getItem("SPOTIM_DEBUG_API")&&console.log("%cSpot.IM Analytics%c Track","background: #823fb5; color: white","background: transparent; color: unset",i),C(i,(n=a.a.get("tenant_config.events-collector.batching",!1),!((e=localStorage.getItem("SPOTIM_PIXELS_BATCHING"))?"*"===e:n))).then((function(){return!0}))}function M(t){return function(n){return T(l({},t,n))}}function A(t){var n=t.source,e=t.spotId,i=t.postId;return{track:function(t){return T({type:t,source:n,spot_id:e,post_id:i})}}}Object(s.a)("Analytics",t.env.PACKAGE_VERSION)}.call(this,e(6))},678:function(t,n,e){var i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(o){if(void 0===(r="function"==typeof(i=o)?i.call(n,e,n,t):i)||(t.exports=r),!0,t.exports=o(),!!0){var a=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=a,s}}}((function(){function t(){for(var t=0,n={};t<arguments.length;t++){var e=arguments[t];for(var i in e)n[i]=e[i]}return n}function n(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(i){function r(){}function o(n,e,o){if("undefined"!=typeof document){"number"==typeof(o=t({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(e);/^[\{\[]/.test(a)&&(e=a)}catch(t){}e=i.write?i.write(e,n):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=n+"="+e+s}}function a(t,e){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");e||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=n(s[0]);if(c=(i.read||i)(c,u)||n(c),e)try{c=JSON.parse(c)}catch(t){}if(r[u]=c,t===u)break}catch(t){}}return t?r[t]:r}}return r.set=o,r.get=function(t){return a(t,!1)},r.getJSON=function(t){return a(t,!0)},r.remove=function(n,e){o(n,"",t(e,{expires:-1}))},r.defaults={},r.withConverter=e,r}((function(){}))}))}}]);
//# sourceMappingURL=vendors~analytics-track~conversation-component~feedback-modal~preRender~render-retry-conversation-bundle.js.map