var InfoxCtx22316 = {
	loaded: false,
	tID: null,
	toElem: null,
	checkScroll: false,
	renderCallback: function() {(function() {
    var posb_22316 = 0;
    var pos_22316 = 0;
    var width_item_22316 = 192;
    var count_item_22316 = 20;
    var margin_22316 = 16;
    var count_item_slide_22316 = 2;
    var all_width_item_22316 = width_item_22316 * count_item_22316;
    if (!window._e_slide_num_22316) {
        window._e_slide_num_22316 = 0;
    }
    window._e_slide_num_22316++;
    var mobile_22316 = false;
    if (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i)) {
        mobile_22316 = true;
    }
   
    var conte_22316 = document.querySelectorAll('.idsc_22316 .wr_out');
    conte_22316 = conte_22316[(window._e_slide_num_22316 - 1)];
    var abc_22316 = conte_22316.querySelector('.idsc_22316 .slide_con');
    var wr_width_22316 = conte_22316.querySelector('.idsc_22316 .wr').offsetWidth;

    if(mobile_22316) {
       conte_22316.classList.add('isMobile___in');
    }

    var count_item_22316 = conte_22316.querySelectorAll('.idsc_22316 .itemrr').length;
    var itemWidth_22316 = conte_22316.querySelectorAll('.idsc_22316 .itemrr')[0].offsetWidth;
    var allWidthItem_22316 = (count_item_22316 * (itemWidth_22316 + margin_22316) + margin_22316);
    var widthContainer_22316 = conte_22316.querySelector('.idsc_22316 .wr').offsetWidth;
    conte_22316.querySelector('.idsc_22316 .wr2').style.width = allWidthItem_22316 + 'px';
    conte_22316.querySelector('.idsc_22316 .edge2-button-right').addEventListener('click', function() {
        sr_22316();
    });

    if (mobile_22316) {
        return false;
    }
    conte_22316.querySelector('.idsc_22316 .wr').onmousemove = function(e) {
        if (slide_run_22316) {
            conte_22316.classList.remove('sld_right');
            conte_22316.classList.remove('sld_left');
            return false;
        }
        var e_pageX_22316 = e.pageX - conte_22316.querySelector('.idsc_22316 .wr').getBoundingClientRect().x;
        var border_22316 = parseInt(widthContainer_22316 / 2);
        if (e_pageX_22316 > border_22316) {
            conte_22316.classList.remove('sld_left');
            if (!hide_r_22316) conte_22316.classList.add('sld_right');
            else conte_22316.classList.remove('sld_right');
        } else {
            conte_22316.classList.remove('sld_right');
            if (!hide_l_22316) conte_22316.classList.add('sld_left');
            else conte_22316.classList.remove('sld_left');
        }
    };
    conte_22316.querySelector('.idsc_22316 .wr').onmouseleave = function(e) {
        conte_22316.classList.remove('sld_left');
        conte_22316.classList.remove('sld_right');
    };
    var hide_r_22316 = false;
    var hide_l_22316 = true;
    var sr_22316 = function() {
        wr_width_22316 = conte_22316.querySelector('.idsc_22316 .wr').offsetWidth;
        var mod_pos_22316 = Math.abs(pos_22316);
        var width_slide_one_22316 = (width_item_22316 * count_item_slide_22316);
        ost_22316 = allWidthItem_22316 - wr_width_22316;
        pred_pos_22316 = mod_pos_22316 + width_slide_one_22316;
        var last_22316 = false;
        if ((ost_22316 - pred_pos_22316) < (count_item_slide_22316 * itemWidth_22316)) last_22316 = true;
        conte_22316.querySelector('.idsc_22316 .wr2').classList.add('wr2_transform');
        hide_l_22316 = false;
        if (last_22316) {
            abc_22316.style.left = '-' + (ost_22316 - 20) + 'px';
            pos_22316 = (ost_22316 - 20) * -1;
            hide_r_22316 = true;
        } else {
            hide_r_22316 = false;
            var ncel_22316 = mod_pos_22316 % width_item_22316;
            if (ncel_22316 > 2) {
                abc_22316.style.left = '-' + (mod_pos_22316 + width_slide_one_22316 - ncel_22316) + 'px';
                pos_22316 = (mod_pos_22316 + width_slide_one_22316) * -1;
            } else {
                abc_22316.style.left = '-' + (mod_pos_22316 + width_slide_one_22316) + 'px';
                pos_22316 = (mod_pos_22316 + width_slide_one_22316) * -1;
            }
        }
        setTimeout(function() {
            conte_22316.querySelector('.idsc_22316 .wr2').classList.remove('wr2_transform');
        }, 500);
    };
    var sl_22316 = function() {
        wr_width_22316 = conte_22316.querySelector('.idsc_22316 .wr').offsetWidth;
        var mod_pos_22316 = Math.abs(pos_22316);
        var width_slide_one_22316 = (width_item_22316 * count_item_slide_22316);
        var first_22316 = false;
        if (mod_pos_22316 <= width_slide_one_22316) first_22316 = true;
        conte_22316.querySelector('.idsc_22316 .wr2').classList.add('wr2_transform');
        hide_r_22316 = false;
        if (first_22316) {
            hide_l_22316 = true;
            abc_22316.style.left = '0px';
            pos_22316 = 0;
        } else {
            hide_l_22316 = false;
            var ncel_22316 = mod_pos_22316 % width_item_22316;
            if (ncel_22316 > 2) {
                abc_22316.style.left = '-' + (mod_pos_22316 - width_slide_one_22316 - ncel_22316) + 'px';
                pos_22316 = (mod_pos_22316 - width_slide_one_22316) * -1;
            } else {
                abc_22316.style.left = '-' + (mod_pos_22316 - width_slide_one_22316) + 'px';
                pos_22316 = (mod_pos_22316 - width_slide_one_22316) * -1;
            }
        }
        setTimeout(function() {
            conte_22316.querySelector('.idsc_22316 .wr2').classList.remove('wr2_transform');
        }, 500);
    };
    conte_22316.querySelector('.idsc_22316 .edge2-button-left').addEventListener('click', function() {
        sl_22316();
    });
    var ie_22316 = 0;
    var op_22316 = 0;
    var ff_22316 = 0;
    var last_pos_x_22316 = 0;
    var last_pos_y_22316 = 0;
    var browser_22316 = navigator.userAgent;
    if (browser.indexOf('Opera') != -1) op_22316 = 1;
    else {
        if (browser.indexOf('MSIE') != -1) ie_22316 = 1;
        else {
            if (browser.indexOf('Firefox') != -1) ff_22316 = 1;
        }
    }
    var block_22316 = conte_22316.querySelector('.wr2');
    delta_x_22316 = 0;
    var slide_run_22316 = false;
    block_22316.onmousedown = saveXY_22316;
    if (op_22316 || ff_22316) {
        block_22316.addEventListener('onmousedown', saveXY_22316, false);
    }
    document.onmouseup = clearXY_22316;

    function saveXY_22316(obj_event_22316) {
        slide_run_22316 = true;
        if (obj_event_22316) {
            x_22316 = obj_event_22316.pageX_22316;
            if (obj_event_22316.touches) x_22316 = obj_event.touches[0].clientX;
            y_22316 = obj_event.pageY;
            if (obj_event.touches) y_22316 = obj_event.touches[0].clientY;
        } else {
            x = window.event.clientX;
            if (obj_event.touches) x_22316 = obj_event.touches[0].clientX;
            if (ie_22316) {
                x_22316 -= 2;
            }
            y_22316 = window.event.clientY;
            if (obj_event_22316.touches) y_22316 = obj_event_22316.touches[0].clientY;
            if (ie_22316) {
                y_22316 -= 2;
            }
        }
        last_pos_x_22316 = x_22316;
        last_pos_y_22316 = y_22316;
        x_block_22316 = block_22316.offsetLeft;
        delta_x_22316 = x_block_22316 - x_22316;
        document.onmousemove = moveBlock_22316;
        if (op_22316 || ff_22316) document.addEventListener('onmousemove', moveBlock_22316, false);
    }

    function clearXY_22316(obj_event_22316) {
        document.onmousemove = null;
        slide_run_22316 = false;
    }
    var old_x_22316 = 0;

    function moveBlock_22316(obj_event_22316) {
        if (obj_event_22316) {
            x_22316 = obj_event_22316.pageX_22316;
            if (obj_event_22316.touches) x_22316 = obj_event_22316.touches[0].clientX;
        } else {
            x_22316 = window.event.clientX;
            if (obj_event.touches_22316) x_22316 = obj_event_22316.touches[0].clientX;
            if (ie_22316) {
                x_22316 -= 2;
            }
        }
        if (Math.abs(pos_22316) > itemWidth_22316) {
            hide_l_22316 = false;
        } else {
            hide_l_22316 = true;
        }
        if ((allWidthItem_22316 - Math.abs(pos_22316) - widthContainer_22316) > itemWidth_22316) {
            hide_r_22316 = false;
        } else {
            hide_r_22316 = true;
        }
        var t_22316 = false;
        if (x_22316 > old_x_22316) t_22316 = true;
        old_x_22316 = x_22316; /* Вычисляем новые координаты блока */
        new_x_22316 = delta_x_22316 + x_22316;
        var sliz_22316 = (allWidthItem_22316 - widthContainer_22316);
        if (new_x_22316 > 0) return false;
        if (!t_22316) {
            if ((conte_22316.querySelector('.idsc_22316 .wr2').offsetLeft + sliz_22316) < 0) return false;
        }
        block_22316.style.left = new_x_22316 + 'px';
        pos_22316 = new_x_22316;
    }




    function outl_22316(e) {
        if (e.changedTouches) {
            x_d_22316 = e.changedTouches[0].clientX;
            y_d_22316 = e.changedTouches[0].clientY;
        }
        var x_d_22316 = e.pageX;
        var y_d_22316 = e.pageY;
        var diff_x_22316 = Math.abs(last_pos_x_22316 - x_d_22316);
        var diff_y_22316 = Math.abs(last_pos_y_22316 - y_d_22316);
        if (diff_x_22316_22316 != 0 && diff_y_22316 != 0) {
            return false;
        }
    }
    var a_22316 = conte_22316.querySelectorAll('.idsc_22316 .linkot');
    for (var i_22316 = a_22316.length - 1; i_22316 >= 0; i_22316--) {
        /*a[i].addEventListener('tuchend', outl, false);*/
        a_22316[i_22316].onclick = outl_22316;
    }
    el_22316 = conte_22316.querySelector('.idsc_22316 .slide_con');
    el_22316.addEventListener('touchstart', saveXY_22316, false);
    el_22316.addEventListener('touchmove', moveBlock_22316, false);
    el_22316.addEventListener('touchend', clearXY_22316, false);
    el_22316.addEventListener('touchdown', clearXY_22316, false);
})();},
	horizontalScroll: true,
	verticalScroll: 0,
	refreshBlock: false,
	zeroPixel: null,
	trackIds: null,
	newTrackIds: null,
	nItems: 0,
	stopTrack: false,
	
	ie10Arr:  null/*IE10ARR*/,   // don't change no one symbol !!!

	getXmlHttp : function() {
		var xmlhttp;
		try {
			xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
		} catch (e) {
			try {
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			} catch (E) {
				xmlhttp = false;
			}
		}
		if (!xmlhttp) {
			var XHR = window.XDomainRequest || window.XMLHttpRequest;
			xmlhttp = new XHR();
		}
		if ("withCredentials" in xmlhttp) {
			xmlhttp.withCredentials = true;
		}
		
		return xmlhttp;
	},

	loadJS : function(url, handler, location) {
	    var scriptTag = document.createElement('script');
	    scriptTag.src = url;
	
	    scriptTag.onload = handler;
	    scriptTag.onerror = handler;
	
	    location.appendChild(scriptTag);
	},
	checkABlock: function(handler) {
		if (window.rbInfoxAdBlock == false) {
			handler(false);
		} else {
			this.loadJS('https://rb.infox.sg/js/ads.js', function() {
				handler(window.rbInfoxAdBlock != false);
			}, document.body); 
		}
	},
	loadNow: function() {
		if (this.loaded)
			return false;
		
		this.loaded = true;
    	window.removeEventListener("scroll", this);
    	
    	if (this.ie10Arr != null) {
    		this.writeItems(this.ie10Arr);
    	} else {
    		var self = this;
	    	self.checkABlock(function(adblock) {
	    		if (window['infoxContextAsyncIdx']===undefined) {
	    			window['infoxContextAsyncIdx'] = 0;
	    		}
	    		var asyncIdx = window['infoxContextAsyncIdx'];
	    		window['infoxContextAsyncIdx'] += 20;
	 			var req = self.getXmlHttp();
				req.open('GET', 'https://rb.infox.sg/json?id=22316&adblock=' + adblock + "&o=" + asyncIdx, true);
				req.onreadystatechange = function() {
					if (req.readyState == 4) {
						var myArr = JSON.parse(req.responseText);
						self.writeItems(myArr);
					}
				};
				req.send();
			});
    	}
		return true;
	},
	
	writeItems: function(arr) {
		if (arr.length > 0) {
			var self = this;
			if (arr.length == 1 && arr[0].code != null) {
				this.toElem.innerHTML = arr[0].code;
				
				var arr = this.toElem.getElementsByTagName('script');
				for (var n = 0; n < arr.length; n++)
				    eval(arr[n].innerHTML);
			} else {
				var html = "<div class='idsc_22316'>    <div class='sg_gor_header'>    	<a href='https://infox.sg' target='_blank'>    		<img src='//banners.adfox.ru/160324/adfox/559207/logo_sg.png'>    	</a>    </div>    <div class='wr_out id_wr_out'>            <div class='wr'>                <div class='widget-edge2 widget-edge2-right'>                    <div class='edge2-button edge2-button-right visible'>                        <div class='edge2-button-arrow edge2-button-arrow-right'></div>                    </div>                </div>                <div class='widget-edge2 widget-edge2-left'>                    <div class='edge2-button edge2-button-left visible'>                        <div class='edge2-button-arrow edge2-button-arrow-left'></div>                    </div>                </div>                <div class='wr2 slide_con'>    ";
				if (this.horizontalScroll) {
					html += "<style>#rb22316scc{overflow-x: scroll;overflow-y:hidden;width: auto;white-space:nowrap;}#rb22316scc>*{display: inline-block;white-space:normal;}</style><div id='rb22316scc'>";
				}
				for (var i = 0; i < arr.length; i++) {
					var item = arr[i];
					html += this.buildItem(item, i);
					this.nItems++;
				}
				if (this.horizontalScroll) {
					html += "</div>";
				}
				html += "                                    </div>            </div>        </div>        <style type='text/css'>    .idsc_22316 .itemrr.bg_black {            background-color: rgba(239, 239, 239, 1);    }    .idsc_22316 .itemrr.bg_black .hidd_bg{        background-image: none;    }        .idsc_22316   .itemrr.bg_black .textt {            color: #000;    background-color: rgba(239, 239, 239, 1);    text-shadow: none;    }        .idsc_22316 .itemrr .textt-before {        content: ' ';        display: block;        height: 35px;        position: absolute;        width: 100%;        left: 0px;        top: -35px;    }        .idsc_22316 .sg_gor_header a{    		font-family: 'Montserrat', Arial, sans-serif;    		font-size: 24px;    		line-height: 12px;    		font-weight: bold;    		color: #000;    		margin-bottom: 10px;    		position: relative;    		padding-right: 38px;    		text-align: left;    		display: block;                    text-decoration: none;    	}     	.idsc_22316 .sg_gor_header_n {    		position: absolute;    		top: 8px;    		right: 0;    		display: inline-block;    		font-size: 11px;    		line-height: 13px;    		font-weight: bold;    		color: #adadad;    	}    .idsc_22316 .sg_gor_header img {                height: 12px;    width: auto;        display: inline-block;            }            .idsc_22316 .sglogo span {                font-family: 'Montserrat', Arial, sans-serif;                font-size: 18px;                line-height: 22px;                font-weight: bold;                color: #000;                position: relative;                text-align: left;            }            .idsc_22316 .sglogo {                display: block;                line-height: 16px;        text-align: left;            }           .idsc_22316  .wr_out,       .idsc_22316  .wr_out div {            box-sizing: border-box;        }            .idsc_22316 .wr {            position: relative;            height: 256px;            overflow: hidden;        }           .idsc_22316  .wr_out {            overflow: hidden;        }           .idsc_22316  .wr2_transform {            transition: left 0.5s linear;        }            .idsc_22316 .wr2 {            width: 2000px;            overflow: hidden;            height: 100%;            position: absolute;            left: 0;            top: 0;        }       .idsc_22316  .textt {        padding: 0 15px 30px;       font-family: Arial, sans-serif;        font-size: 16px;        line-height: 19px;        font-weight: bold;            color: #fff;            text-decoration: none;            text-align: left;            word-wrap: break-word;            -webkit-line-clamp: 6;            -webkit-box-orient: vertical;            position: absolute;            bottom: 0;            z-index: 22;            left: 0;            -webkit-touch-callout: none;            -webkit-user-select: none;            -khtml-user-select: none;            -moz-user-select: none;            -ms-user-select: none;            user-select: none;        }    .idsc_22316 .hidd_bg {        position: absolute;        width: 100%;        height: 75px;        bottom: 64px;        left: 0;        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(34,34,34,0)), to(#222));        background-image: -moz-linear-gradient(rgba(34,34,34,0), #222);        background-image: linear-gradient(rgba(34,34,34,0), #222);    }      .idsc_22316   .itemrr {            border-radius: 4px;            overflow: hidden;            background-size: cover;            width: 192px;            height: 256px;            float: left;            margin-right: 16px;            position: relative;            transition: box-shadow;            transition-duration: 0.8s;            transition-property: box-shadow;            will-change: box-shadow;            background: #222;        }       .idsc_22316   .itemrr a:after {        content: '';        display: block;        position: absolute;        top: 0;        right: 0;        left: 0;        bottom: 0;        width: 100%;        height: 100%;        border-radius: 4px;        z-index: 1;    }       .idsc_22316  .itemrr:hover {            box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.28), 0 4px 21px 0 rgba(0, 0, 0, 0.22);        }          .idsc_22316   .itemrr:last-child {            margin-right: 0px;        }         .idsc_22316    .itemrr .linkot img {            height: 100%;        }        .idsc_22316     .itemrr .linkot {            display: block;            height: 100%;            position: relative;            z-index: 200;        }         .idsc_22316    .hidd {            left: 0px;            position: absolute;            top: 0px;            width: 100%;        }          .idsc_22316   .edge2-button {            z-index: 10;            position: absolute;            top: 50%;            transform: translateY(-50%) translateZ(0);            will-change: transform;            height: 68px;            width: 44px;            display: block;            cursor: pointer;            transition: transform 0.5s ease;            border-radius: 4px;            background-color: #fff;            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.18);        }        .idsc_22316     .edge2-button-arrow {            position: relative;        }        .idsc_22316     .edge2-button-arrow-right:after {            content: '';            position: absolute;            bottom: -44px;            border: 9px solid transparent;            left: 18px;            border-left: 12px solid #000;        }        .idsc_22316     .edge2-button-arrow-left:after {            content: '';            position: absolute;            bottom: -44px;            border: 9px solid transparent;            left: 9px;            border-right: 12px solid #000;        }        .idsc_22316     .widget-edge2-right {            right: 0;        }         .idsc_22316    .widget-edge2-left {            left: 0;        }        .idsc_22316     .widget-edge2 {            width: 40px;            position: absolute;            top: 0px;            bottom: 0px;            z-index: 299;            will-change: transform;            transform: translateZ(0);        }        .idsc_22316     .wr_out {            position: relative;        }        .idsc_22316     .edge2-button-right {            right: -70px;        }        .idsc_22316     .edge2-button-left {            left: -74px;        }        .idsc_22316     .sld_right.wr_out .edge2-button-right {            transform: translateY(-50%) translateX(-100%) translateX(-36px);        }         .idsc_22316    .sld_left.wr_out .edge2-button-left {            transform: translateY(-50%) translateX(100%) translateX(40px);        }         .idsc_22316    .sld_left_hide.sld_left.wr_out .edge2-button-left {            display: none;        }          .idsc_22316   .sld_right_hide.sld_right.wr_out .edge2-button-right {            display: none;        }        .idsc_22316     .isMobile___in.wr_out .edge2-button-right {            transform: translateY(-50%) translateX(-100%) translateX(-36px) !important;        }        .idsc_22316     .isMobile___in.wr_out .edge2-button-left {            transform: translateY(-50%) translateX(100%) translateX(40px) !important;        }        .idsc_22316     .isMobile___in.wr_out .edge2-button-right,    .idsc_22316     .isMobile___in.wr_out:hover .edge2-button-right {            display: none !important;        }        .idsc_22316     .isMobile___in.wr_out .edge2-button-left,    .idsc_22316     .isMobile___in.wr_out:hover .edge2-button-left {            display: none !important;        }    .idsc_22316     .isMobile___in .wr {            overflow: hidden !important;            overflow-x: scroll !important;             -webkit-overflow-scrolling: touch;        }    .idsc_22316     .isMobile___in ::-webkit-scrollbar {            display: none;        }    .idsc_22316     .isMobile___in::-webkit-scrollbar { width: 0; }    .idsc_22316     .isMobile___in { -ms-overflow-style: none; }    .idsc_22316     .isMobile___in { overflow: -moz-scrollbars-none; }        </style>    </div>";
				html += "";
				this.toElem.innerHTML = html;
				if (this.horizontalScroll) {
					var scont = document.getElementById("rb22316scc");
					this.trackIds = [];
					var checkItems = function() {
						var from = scont.scrollLeft;
						var to = scont.clientWidth + from;
						var childs = scont.childNodes;
						var x = 0;
						self.newTrackIds = [];
						for (var i in childs) {
							var child = childs[i];
							if (typeof child.hasAttribute === 'function' && child.hasAttribute("rbid")) {
								var x2 = x + child.offsetWidth;
								if ((from <= x && to >= x) || (from <= x2 && to >= x2)) {
									var id = child.getAttribute("rbid");
									if (self.trackIds.indexOf(id) < 0) {
										self.trackIds.push(id);
										self.newTrackIds.push(id);
									}
								}
								x = x2;
							}							
						}
						return self.newTrackIds.length > 0;
					}
					scont.addEventListener("scroll", function(evt) {
						if (checkItems()) {
							self.trackOnScroll();
						}
					}); 
					checkItems();
				}
				if (this.ie10Arr == null) {
					this.toElem.addEventListener("click", function(e) {
						var element = self.findItem(e.target);
						if (!element) return;
						self.refreshElements(element.parentNode, new Array(element));
					});
					if (this.refreshBlock) {
						var onchange = function() {
							if (document.visibilityState != "hidden") {
								var container = self.findContainer(self.toElem);
								self.refreshElements(container, container.childNodes);
							}
						};
						var hidden = "hidden";
						// Standards:
						if (hidden in document)
						    document.addEventListener("visibilitychange", onchange);
						else if ((hidden = "mozHidden") in document)
						    document.addEventListener("mozvisibilitychange", onchange);
						else if ((hidden = "webkitHidden") in document)
						    document.addEventListener("webkitvisibilitychange", onchange);
						else if ((hidden = "msHidden") in document)
						    document.addEventListener("msvisibilitychange", onchange);
						// IE 9 and lower:
						else if ("onfocusin" in document)
						    document.onfocusin = document.onfocusout = onchange;
						// All others:
						else
						    window.onpageshow = window.onpagehide = window.onfocus = window.onblur = onchange;
					}
				}
			}
			if (this.checkScroll) {
				window.addEventListener("scroll", this); 
			}
			if (this.zeroPixel) {
				var img = document.createElement("img");
				img.setAttribute("src", this.zeroPixel);
				img.setAttribute("width", "1");
				img.setAttribute("height", "1");
				img.setAttribute("style", "display: none");
				document.getElementsByTagName('body')[0].appendChild(img);
			}
			this.trackOnScroll();
			if (self.renderCallback) self.renderCallback(); 
		}
	},
	
	refreshElements: function(parent, elements) {
		var self = this;
		var ids = "";
		var childs = parent.childNodes;
		for (var i in childs) {
			var child = childs[i];
			if (typeof child.hasAttribute === 'function' && child.hasAttribute("rbid")) {
				if (ids.length>0) ids += ",";
				ids += child.getAttribute("rbid");
			}
		}
			var req = self.getXmlHttp();
		req.open('GET', 'https://rb.infox.sg/json?id=22316&n=' + elements.length + '&exclude=' + ids, true);
		req.onreadystatechange = function() {
			if (req.readyState == 4) {
				var myArr = JSON.parse(req.responseText);
				var ei = 0
				for (var i in myArr) {
					var element = null;
					while (ei < elements.length) {
						element = elements[ei++];
						if (typeof element.hasAttribute === 'function' && element.hasAttribute("rbid")) {
							break;
						}
					}
					var item = self.buildItem(myArr[i], element.getAttribute("rbpos"));
					if (element) {
						element.insertAdjacentHTML('afterend', item);
						element.parentNode.removeChild(element);
					} else {
						parent.append(item);
					}
				}
				if (myArr.length > 0) {
					self.trackOnScroll();
					if (self.renderCallback) self.renderCallback(); 
				}
			}
		};
		req.send();
	},
	
	buildItem: function(item, i) {
		var str = "<div class='itemrr' style='background-color: rgb({bg_rgb});'>    <img class='hidd' src='{img}' crossorigin='anonymous' alt=''>    <a class='linkot' target='_blank' href='{url}'>        <div class='textt' style='background-color: rgb({bg_rgb}); color: {text_color}'>        <div class='textt-before' style='background: linear-gradient(to bottom, rgba({bg_rgb}, 0) 0%, rgba({bg_rgb}, 1) 100%)'></div>        {title}</div>    </a>    </div>";
		str = str.replace(/\{url\}/g, item.url)
				.replace(/\{img\}/g, item.img)
				.replace(/\{width\}/g, item.width)
				.replace(/\{height\}/g, item.height)
				.replace(/\{title\}/g, item.title)
				.replace(/\{category\}/g, item.category)
				.replace(/\{body\}/g, item.body || '')
				.replace(/\{source\}/g, item.source || '')
				.replace(/\{bg_rgb\}/g, item.bg_rgb || '')
				.replace(/\{bg_hex\}/g, item.bg_hex || '')
				.replace(/\{text_color\}/g, item.text_color || '')
				.replace(/\{n\}/g, i);
		str = this.fixLinkTarget(item.linkTarget, str);
		var idx = str.indexOf('>');
		if (idx > 0) {
			str = str.substr(0, idx) + " rbn='" + i + "'" + " rbid='" + item.id + "'" + str.substr(idx);
		}
		return str;
	},
	
	findItem: function(elem) {
		if (elem.hasAttribute("rbid")) {
			return elem;
		}
		if (elem.parentNode) {
			return this.findItem(elem.parentNode);
		}
		return null;
	},

	findContainer: function(element) {
		var childs = element.childNodes;
		for (var i in childs) {
			var child = childs[i];
			if (typeof child.hasAttribute === 'function' && child.hasAttribute("rbid")) {
				return element;
			}
			var container = this.findContainer(child);
			if (container) {
				return container;
			}
		}
		return null;
	},

	fixLinkTarget: function(linkTarget, str) {
		if (linkTarget != 'byDefault') {
			str = str.replace(/target=["'][^'"]*["']/g, '');

			if (linkTarget == 'blank')
				str = str.replace(/href=/g, ' target="_blank" href=');
		}
		return str;
	},
	
	shuffle : function(array) {
		var currentIndex = array.length, temporaryValue, randomIndex;

		// While there remain elements to shuffle...
		while (0 !== currentIndex) {

			// Pick a remaining element...
			randomIndex = Math.floor(Math.random() * currentIndex);
			currentIndex -= 1;

			// And swap it with the current element.
			temporaryValue = array[currentIndex];
			array[currentIndex] = array[randomIndex];
			array[randomIndex] = temporaryValue;
		}

		return array;
	},

	positions: function() {
    	var scrollTop = window.pageYOffset || document.documentElement.scrollTop;
		var scrollHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
	    var box = this.toElem.getBoundingClientRect();
	    var clientTop = this.toElem.clientTop || 0;
	    var top  = box.top +  scrollTop - clientTop;
	    var h = this.toElem.offsetHeight;
	    
	    return {
	    	isLoadPosition: function() { return scrollTop + scrollHeight > top; },
	    	isTrackPosition: function() {return scrollTop + scrollHeight > top + h / 2 && top + h > scrollTop; }
	    }
	},
	
    loadOnScroll : function() {
    	if (this.loaded)
    		return true;
    	
    	var pos = this.positions();
		if (pos.isLoadPosition()) {
			this.loadNow();
			return true;
		}
		return false;
	},
	
	trackOnScroll: function() {
		var pos = this.positions();
		if (pos.isTrackPosition() || !this.checkScroll) {
			var self = this;
			if (!this.stopTrack && ! this.tId) {
				this.tId = setTimeout(function() {
					if (self) {
						if (self.loaded) {
							window.removeEventListener("scroll", self); 
						}
						self.stopTrack = true;
						var req = self.getXmlHttp();
						req.open('GET', 'https://rb.infox.sg/track' + (self.newTrackIds !== null && self.newTrackIds.length > 0 ? "?ids=" + self.newTrackIds.toString() : ""), true);
						req.onreadystatechange = function() {
							if (req.readyState == 4) {
								self.stopTrack = false;
							}
						};
						req.send(null);
						if (self.newTrackIds) {
							self.newTrackIds = [];
						}
					}
				}, 1000);
			}
			if (this.loaded && this.verticalScroll > this.nItems) {
	    		var div = document.createElement('div');
	    		this.toElem.append(div);
	    		this.loaded = false;
	    		this.init(div);
			}
		} 
		else if (this.tId) {
			clearTimeout(this.tId);
			this.tId = null;
		}
		return;
	},

	handleEvent: function (event) { 
		if (this.loaded) {
			this.trackOnScroll();
		} else {
			this.loadOnScroll();
		}
	},
	
	init: function(toElem) {
		this.toElem = toElem;
		if (this.checkScroll) {
			if (!this.loadOnScroll()) {
				window.addEventListener("scroll", this);
			}
		}
		else
	    	this.loadNow();
	}
}
var INFOX22316 = {
	
	renderTo : function(divId) {
		var toElem = document.getElementById(divId);
		if (! toElem ) 
			return;
		var ctx = Object.create(InfoxCtx22316);
		ctx.init(toElem);
	},
	
	init : function() {
		var blocks = window['infoxContextAsyncCallbacks22316'];
		if (blocks) {
			while (true) {
				var block = blocks.pop();
				if (block) {
					block();
				} else {
					break;
				}
			}
		}
	}
};
INFOX22316.init();