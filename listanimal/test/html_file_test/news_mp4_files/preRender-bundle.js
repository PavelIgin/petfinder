(window.webpackJsonp_spotim_4006192861=window.webpackJsonp_spotim_4006192861||[]).push([[55],{900:function(e,t,n){"use strict";n.r(t);var a=n(21),i=n.n(a),r=n(22),s=n.n(r),o=n(2),c=n(9),d=n.n(c),l=n(15),u=n.n(l),p=n(11),g=(n(413),n(66)),v=n(4),m=n(0),f=n.n(m),h=n(259),b=n(42),O=n(221),j=f.a.get("tenant_config.shared.defensiveJsMode",!1),_=f.a.get("tenant_config.conversation.cssModulesForShadowDOM","conversation conversation-survey @spotim/ui-components @spotim/ads @spotim/user-image feed @spotim/entities @spotim/user-info @spotim/rich-editor @spotim/toast-provider @spotim/content-entities"),y=function(e){var t=Object(p.useSelector)((function(e){return e.appState})),n=t.isUserInitialized,a=t.isTranslationInitialize,i=t.isTokenInitialized;return Object(c.useEffect)((function(){var t,r;n&&a&&i&&(null===(t=window.__SPOTIM__)||void 0===t||null===(r=t.removeLoadingIndicator)||void 0===r||r.call(t,e.element))}),[n,a,i]),n&&a&&i?d.a.createElement(c.Suspense,{fallback:null},d.a.createElement(g.a,{container:e.element})):null};function I(e,t,n){var a,r=document.createElement("div");!(e.getRootNode()instanceof ShadowRoot)&&g.b&&r.attachShadow&&window.__SPOTIM__.stylesheetElementAdded&&(r.attachShadow({mode:"open"}),Object(v.exposeAnimationEvents)(r,{defensiveMode:j})),r.setAttribute("data-spot-im-shadow-host",_),e.appendChild(r),a=Object(O.a)(e),Object(h.a)(a).addEventListener("click",function(){var e=s()(i.a.mark((function e(t){var n,a,r,s,o,c,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=null===(n=(a=null==t?void 0:t.target).getAttribute)||void 0===n?void 0:n.call(a,"data-spot-im-class"))&&(c=null===(s=(o=null==t?void 0:t.target).getBoundingClientRect)||void 0===s?void 0:s.call(o),d=new CustomEvent(b.v,{detail:{spotImClass:r,elementTop:c.top}}),document.dispatchEvent(d));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!1),u.a.render(d.a.createElement(c.Suspense,{fallback:null},d.a.createElement(p.Provider,{store:t.store},d.a.createElement(y,{element:e}))),r.shadowRoot||r,n)}n(812);var x=n(44);function w(e,t,n){var a=t.postUrl,i=t.href,r=t.ignoreHostUrl,s=t.canonicalHref,o=t.highlight,c=t.disqusIdentifier,d=t.disqusUrl,l=t.gigyaStreamId,u=t.gigyaCategoryId,p=t.wpImportEndpoint,g=t.facebookUrl,v=t.livefyreUrl,m=t.iosUrl,f=t.androidUrl,h=t.isRecommendedPost,b=t.conversationAuthorId,O=t.conversationArticleTags,j=t.isConversationLiveBlog,_={platform:n?"mobile":"desktop"};if(b||O){var y={};b&&Object.assign(y,{author_id:b}),O&&Object.assign(y,{article_tags:O.trim()}),Object.assign(_,{metadata:y})}m&&Object.assign(_,{ios_url:m}),f&&Object.assign(_,{android_url:f}),h||Object.assign(_,{recommended_post:h}),i&&Object.assign(_,{host_url:i}),(a||s)&&Object.assign(_,{canonical_url:a||s}),o&&Object.assign(_,{highlight:o}),r&&Object.assign(_,{ignore_host_url:r}),j&&Object.assign(_,{is_conversation_live_blog:j});var I={};return c&&Object.assign(I,{disqus_identifier:c}),d&&Object.assign(I,{disqus_url:d}),l&&Object.assign(I,{gigya_streamid:l}),u&&Object.assign(I,{gigya_categoryid:u}),g&&Object.assign(I,{facebook_url:g}),v&&Object.assign(I,{livefyre_url:v}),p&&Object.assign(I,{wp_import_endpoint:p}),Object.keys(I).length>0&&Object.assign(_,{import_hints:I}),Object(x.a)("v1.0.0/conversation/async",{postId:e,method:"POST",data:_})}var E=n(364),T=n(258),S=n(36),k=n(442),C=n(79),M=n.n(C),R=n(195),P=["spsl","sections"];function U(e){var t,n={startTag:{startIndex:0,endIndex:0},endTag:{startIndex:e.length,endIndex:e.length},children:[],sections:[],parent:null,tagName:"root"},a=n,i=new R.Parser({onopentag(e,n){if(P.indexOf(e)>-1){var r=[];"sections"===e&&n.names&&r.push.apply(r,M()(n.names.split(","))),(t={children:[],sections:r,parent:a,tagName:e}).startTag={startIndex:i.startIndex,endIndex:i.endIndex+1},a.children.push(t),a=t}},onclosetag(e){P.indexOf(e)>-1&&a.tagName===e&&(a.endTag={startIndex:i.startIndex,endIndex:i.endIndex+1},a=a.parent)}},{recognizeSelfClosing:!1,xmlMode:!1});return i.write(e),i.end(),function e(t,n,a){var i=n.startTag,r=n.endTag,s=n.children,o=n.sections,c=i.endIndex,d=[],l={"*":""},u=[].concat(M()(a),M()(o)).filter((function(e,t,n){return n.indexOf(e)===t}));if(s.forEach((function(n){var a=t.substring(c,n.startTag.startIndex);d.push(a.trim());var i=e(t,n,u);c=n.endTag.endIndex,Object.keys(i).forEach((function(e){l[e]=l[e]||"",l[e]+=i[e]}))})),c<r.startIndex){var p=t.substring(c,r.startIndex);d.push(p.trim())}return(d=d.join("").trim()).length>0&&(u.length>0?u.forEach((function(e){l[e]=l[e]||"",l[e]=d+l[e]})):l["*"]=d+l["*"]),l}(e,n,[])}function A(e,t){var n=U(e);return n["*"]+(n[t]||"")}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.id;if(!n||!document.getElementById(n)){var a=document.createElement("style");a.type="text/css",n&&(a.id=n),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e));var i=document.head||document.getElementsByTagName("head")[0];i.appendChild(a)}}var N=n(403),q=n(813),z=n.n(q);function L(){var e=z.a.stringify(),t=document.querySelector("div[data-svg-sprite]");t||(t=document.createElement("div")).setAttribute("data-svg-sprite","true"),t.innerHTML=e,document.body.appendChild(t)}var H=n(50);function J(e,t){return D.apply(this,arguments)}function D(){return(D=s()(i.a.mark((function e(t,n){var a,r,s,c,d,l,u,p,g,v,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(O.a)(t),r=n.store.getState(),s=n.postId,c=n.isConversationPage,d=n.isLiveBlog,l=n.contentType,u=Object(k.a)(r,a),p=u.styleBlock,g=u.scriptBlock,v=u.isMobile;try{c||(m=T.a&&!d&&Object(S.b)(r),Object(E.a)(s).startObservingOn(t,m||"conversation"))}catch(e){o.a.error("preRender","time-spent not properly initialized")}if(g)try{g=A(g,"conversation-frame"),Object(N.a)(t,void 0,{content:g})}catch(e){o.a.error("preRender",e)}if(p)try{B(p=A(p,"conversation-frame"))}catch(e){o.a.error("preRender",e)}I(t,n,(function(){g&&(g=A(g,"conversation-frame"),Object(N.a)(t,void 0,{content:g})),p&&B(p=A(p,"conversation-frame"));var e=Object(k.a)(n.store.getState(),a);l&&l!==H.b.Post&&w(s,e,v)})),L();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.d(t,"preRender",(function(){return J}))}}]);
//# sourceMappingURL=preRender-bundle.js.map